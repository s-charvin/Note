# 关于 MyScript 交互式墨迹 SDK

MyScript 交互式墨迹 SDK（通常缩写为 iink SDK）是 MyScript 提供的开发工具包，可帮助集成商构建支持交互式墨迹的应用程序。

其目标是在灵活性和集成性之间实现适当的平衡，以便最大限度地为最终用户带来价值，从而在优化上市时间。

交互式墨迹 SDK 构建为：

- 与各种用例相关，
- 跨平台，
- 易于使用，可与其他解决方案互操作，
- 灵活适应不同的集成方案，
- 符合[交互式墨迹](https://developer.myscript.com/docs/concepts/interactive-ink/)原则。

## [用例](https://developer.myscript.com/docs/interactive-ink/1.3/overview/about/#use-cases)

有许多用例，笔输入可以为用户的工作流增加价值。在当前版本的 iink SDK 可以推送到下一个级别的用例中，我们可以突出显示以下非详尽列表：

- **记笔记**，能够使用文本或文本文档[内容类型](https://developer.myscript.com/docs/interactive-ink/1.3/overview/content-types/)来支持简单或高级笔记，具体取决于您打算输入短笔记还是具有高级布局功能的复杂笔记。
- **表单填写**，具有[不同类型的](https://developer.myscript.com/docs/interactive-ink/1.3/overview/content-types/)字段，可以直接填充在画布上或专用输入中，并导出以进行验证和自动处理。
- **图输入**（例如，在办公套件中），让用户快速向文档添加[图表](https://developer.myscript.com/docs/interactive-ink/1.3/overview/diagram-features/)，而无需通过多个形状或选项托盘进行战斗。
- **数学或基于文本的练习**，能够编写这些类型的内容，并提取学生输入以自动提示或评估。



计划提供更多工具，以解决未来版本中的输入方法用例。

## [跨平台](https://developer.myscript.com/docs/interactive-ink/1.3/overview/about/#cross-platform)

为了让您到达用户所在的位置，无论他们的设备是什么，或者您正在构建的平台，我们设计了 iink SDK，以便从零开始可移植，具有有限的特定于平台的部分。

交互式墨水 SDK 已经支持[多个平台](https://developer.myscript.com/docs/interactive-ink/1.3/overview/platforms/)，包括移动、桌面和 Web。

我们的目标是让所有支持的平台在每次有意义时提供相同的功能集。虽然某些平台（如 Web）尚未支持 iink SDK 可能实现的全部内容，但由于它们构成的具体挑战，我们正在努力改进这方面的工作。

## [易用性和互操作性](https://developer.myscript.com/docs/interactive-ink/1.3/overview/about/#ease-of-use-and-interoperability)

借助交互式墨水 SDK，MyScript 为您完成繁重的工作，将其二十年来的手写识别经验融入**到简单的 API**和**合理的默认配置**中。



如果需要这样做，选择多种[配置](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)或[样式](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/)选项仍允许您调整默认行为，而无需自行实现任何操作。

我们还致力于保持接近您所知道的，与**平台特定的绑定**和**流行的包管理器**（如[CocoaPods](https://cocoapods.org/)或[NuGet）](https://www.nuget.org/)的支持，使集成 MyScript 技术变得轻松。

最后，我们赞成对模型内容进行**语义操作**，支持可读和可解析[的交换格式](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/)，从而能够与主机应用程序或任何第三方解决方案交换信息。

## [集成灵活性](https://developer.myscript.com/docs/interactive-ink/1.3/overview/about/#integration-flexibility)

除了[跨平台](https://developer.myscript.com/docs/interactive-ink/1.3/overview/about/#cross-platform)特性外，iink SDK 还旨在实现[集成方案](https://developer.myscript.com/docs/interactive-ink/1.3/overview/integration-levels/)方面的巨大灵活性：

- **图形组件**（目前仅适用于 Web）和平台特定部件（包括某些 UI 部件）的**即用式实现**，便于快速满足光集成需求。
- **特定于平台的绑定**允许您访问更灵活的 API，该 API 允许您实现用例、调整提供的平台实现，甚至开发全新的平台实现以支持您需要使用的任何特定图形工具包。
- **C++（**可访问的[按需](https://developer.myscript.com/contact/quote-on-device-hwr)）或**WebSocket API**可在需要时为您提供更大的灵活性。

## [支持交互式墨迹](https://developer.myscript.com/docs/interactive-ink/1.3/overview/about/#interactive-ink-enabled)

交互式墨迹 SDK 是建立在[MyScript 交互式墨迹](https://developer.myscript.com/docs/concepts/interactive-ink/)带来的原则之上的。这包括支持编辑和修饰手势、考虑到输入语义解释的动态布局管理、类型集转换以及与第三方解决方案的互操作性。

我们的目标是为您提供一个工具包，让您的最终用户高效工作。

# 新增 1.3

交互式墨水 SDK 1.3 附带了改进和几个值得注意的新功能。本页提供更改的概述。



如果从 1.2 升级，请查看[迁移指南](https://developer.myscript.com/docs/interactive-ink/1.3/overview/migration-guide/)。

## [新的识别资产生成器](https://developer.myscript.com/docs/interactive-ink/1.3/overview/changelog/#new-recognition-assets-builder)

一个新的工具被添加到iink SDK，让你动态地生成[文本词典](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#lexicon)和[数学语法](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#math-grammar)。

除此之外，还新增了用于生成自定义识别资产的预先存在的[在线工具](https://developer.myscript.com/support/recognition-assets/#resource-builder)。

这种动态生成派上用场，让最终用户将自己的单词添加到应用内字典中，或生成完全适应给定数学练习的数学语法。

•[自定义识别](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/)
•[构建自定义资源](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/build-custom-resources/)

## [数学 JIIX 导入](https://developer.myscript.com/docs/interactive-ink/1.3/overview/changelog/#math-jiix-import)

现在可以导入数学 JIIX 内容。请注意，此导入将替换任何现有内容。

•[内置导入格式](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#available-imports)

## [JIIX 的风格和装饰出口](https://developer.myscript.com/docs/interactive-ink/1.3/overview/changelog/#style-and-decoration-export-in-jiix)

借助 iink SDK 1.3，现在可以通过 JIIX 导出获取样式信息，包括可能检测到的装饰。

您需要显式将配置选项设置为 JIIX 以包括样式信息（默认值为 ）。`export.jiix.style``true``false`



JIIX 已演变为版本 2 以支持此新功能。有关详细信息，请查看[迁移指南](https://developer.myscript.com/docs/interactive-ink/1.3/overview/migration-guide/)和[JIIX 参考](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/)。

## [更灵活的 JIIX 导出](https://developer.myscript.com/docs/interactive-ink/1.3/overview/changelog/#more-flexible-jiix-export)

- 设置的行为已演变为仅命令导出墨迹笔画。`export.jiix.strokes`
- 已添加两个新的配置选项 （ 和 ）， 默认情况下都设置为 ， 分别已添加到已转换字形和形状基元导出的命令中。`export.jiix.glyphs``export.jiix.primitives``true`

## [Web 中文本部件的新导出](https://developer.myscript.com/docs/interactive-ink/1.3/overview/changelog/#new-export-for-text-parts-in-the-web)

Web 平台获得了将"文本"部件导出到 iink、单词和 HTML 文档的能力。

## [更新到最新的 MyScript 技术](https://developer.myscript.com/docs/interactive-ink/1.3/overview/changelog/#update-to-the-latest-myscript-technology)

交互式墨水 SDK 1.3 基于最新版本的 MyScript 核心识别 SDK，从而提高了识别性能和准确性。例如，Lexicons 已经更新以支持新的常用单词。

虽然 iink SDK 1.2 提供的识别资产将保持兼容，但如果将用户迁移到 1.3，则可能需要将用户更新为最新资产。

## [其他更改](https://developer.myscript.com/docs/interactive-ink/1.3/overview/changelog/#other-changes)

- 改进了类型集数学表达式（如总和和限制）的布局，适用于更接近其 LaTeX 等效项的渲染。
- 对于本机平台，引入新的 API 允许您检索传递给给定编辑器的视图大小。
- 已为 UWP 和 WPF 更新了 Windows API，允许您选择直接调用 C# 方法来释放 iink 内部内存，而不是等待垃圾回收器。`Dispose()`

# 从 1.2 迁移

此页列出了将现有代码从 iink SDK 1.2 迁移到新 iink SDK 1.3 时需要注意的要点。

## [JIIX 格式演变](https://developer.myscript.com/docs/interactive-ink/1.3/overview/migration-guide/#jiix-format-evolution)

JIIX 格式已更新为版本 2。这允许包含样式和装饰信息，并使得 iink SDK 导入了数学 JIIX。如果要分析 JIIX 输出，则必须更新解析器代码，以遵循此新版本附带的（小型）演变。



交互式墨迹 SDK 1.3 只能导入 JIIX 版本 2 文档。万一要导入由工具包的早期版本生成的 JIIX 文件，您必须自行迁移其内容。

• [JIIX 参考](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/)（更新至版本 2）

### [版本标识](https://developer.myscript.com/docs/interactive-ink/1.3/overview/migration-guide/#version-identification)

虽然原始 JIIX 规范不包含任何版本控制信息，但新的"版本"密钥已添加到根 JSON 对象中。它有一个字符串值（当前为"2"）标识格式的迭代。

### [主要更改](https://developer.myscript.com/docs/interactive-ink/1.3/overview/migration-guide/#key-changes)

- 数组已被数组替换，该数组收集笔画、字形和形状基元。`strokes``items`
- 对于绘图块，已添加新数组以引用项范围的"跨"对象的形式存储样式。`spans`
- 对于文本块，已添加新数组以引用字符范围的"span"对象的形式存储样式。`spans`
- 将新的和属性添加到数学和关系图节点。`class``style`
- 已删除与所有块中的墨迹关联的属性。`range`
- 所有块现在都有一个属性。`id`



您需要将配置键设置为，以便样式信息导出到 JIIX。另请注意，将仅导出动态样式、笔样式类和与装饰一起应用的样式。编辑器级样式表不会。`export.jiix.style``true`

## [批处理模式更改](https://developer.myscript.com/docs/interactive-ink/1.3/overview/migration-guide/#batch-mode-changes)

从 iink SDK 1.3 开始，无法再直接导入"文本文档"部件中的[指针事件批次](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#series-of-events)。这一变化的动机是，很难使墨迹在参考线上正确对齐以获得良好的识别结果。

如果您想实现类似的行为，现在鼓励您：

1. 根据要处理的内容类型，将每批指针事件发送到专用的"文本"、"数学"、"图表"或"绘图"部分。如果无法确保"文本"零件与墨迹字的基线匹配，请记住禁用"文本"零件上的[参考线](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#guides)。
2. 调用以确保识别完成。`waitForIdle()`
3. 以块形式粘贴到适当位置的"文本文档"部分。



将"文本"部分粘贴到"文本文档"中时，iink SDK 将尝试自动将手写内容调整为参考线。

# 支持的平台

## [平台和 API](https://developer.myscript.com/docs/interactive-ink/1.3/overview/platforms/#platform-and-apis)

下表列出了当前通过 MyScript 开发人员门户支持的平台和体系结构：

| Platform                                                     | Min version                                                  | Max version[1](https://developer.myscript.com/docs/interactive-ink/1.3/overview/platforms/#fn:1) | Architectures                               | APIs                                                         |
| :----------------------------------------------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- | :------------------------------------------ | :----------------------------------------------------------- |
| Android[2](https://developer.myscript.com/docs/interactive-ink/1.3/overview/platforms/#fn:2) | 5.0                                                          | 9.0                                                          | `armeabi-v7a`, , , `arm64-v8a``x86``x86_64` | Java Android                                                 |
| iOS                                                          | 9.0                                                          | 12.0                                                         | `armv7`, `arm64`                            | Objective-C (Swift-compatible)                               |
| Windows UWP[3](https://developer.myscript.com/docs/interactive-ink/1.3/overview/platforms/#fn:3) | Build 10240[4](https://developer.myscript.com/docs/interactive-ink/1.3/overview/platforms/#fn:4) | Build 17763[4](https://developer.myscript.com/docs/interactive-ink/1.3/overview/platforms/#fn:4) | `x86`, `x64`                                | WinRT                                                        |
| Windows Desktop[3](https://developer.myscript.com/docs/interactive-ink/1.3/overview/platforms/#fn:3) | Windows 7[5](https://developer.myscript.com/docs/interactive-ink/1.3/overview/platforms/#fn:5) | Build 17763[4](https://developer.myscript.com/docs/interactive-ink/1.3/overview/platforms/#fn:4) | `x86`, `x64`                                | .NET[6](https://developer.myscript.com/docs/interactive-ink/1.3/overview/platforms/#fn:6) |
| Web                                                          |                                                              |                                                              |                                             | Web component, JavaScript, WebSocket, REST                   |

如果您的要求扩展到其他平台，[请联系我们的销售团队](https://developer.myscript.com/contact-us/on-device-recognition)。

## [我应该去本地还是网络？](https://developer.myscript.com/docs/interactive-ink/1.3/overview/platforms/#should-i-go-native-or-web)

答案取决于您的要求。

如果以下情况：以下情况，您应该使用本机版本：

- 您不能允许或确保您的用户访问互联网连接。
- 您需要向最终用户提供 Web 中尚不支持[的内容类型](https://developer.myscript.com/docs/interactive-ink/1.3/overview/content-types/)，如关系图或文本文档。
- 您希望对考虑或希望使用链接到手写笔的特定硬件功能的设备类型进行精细控制。
- 您希望避免将数据发送到远程服务器。

如果以下情况：

- 您正在开发一个 Web 或混合应用程序。
- 您希望将识别开销卸载到远程服务器，以在本地设备上备用资源。
- 您有数据机密性限制，但已准备好托管 iink SDK 服务器。



如果您对 iink SDK 服务器的本地版本感兴趣，[请联系我们的销售团队](https://developer.myscript.com/contact-us/cloud-recognition)了解更多信息和定价。

1. 当前版本的最后限定版本。从理论上讲，平台的较新版本应该兼容。[↩](https://developer.myscript.com/docs/interactive-ink/1.3/overview/platforms/#fnref:1)
2. 可以嵌入到在 Chrome 操作系统上运行的 Android 应用程序中[，↩](https://developer.myscript.com/docs/interactive-ink/1.3/overview/platforms/#fnref:2)
3. 视觉工作室 2015 和 2017 [↩](https://developer.myscript.com/docs/interactive-ink/1.3/overview/platforms/#fnref:3) [↩2](https://developer.myscript.com/docs/interactive-ink/1.3/overview/platforms/#fnref:3:1)
4. [windows 10 版本](https://docs.microsoft.com/en-us/windows/uwp/updates-and-versions/choose-a-uwp-version)[↩](https://developer.myscript.com/docs/interactive-ink/1.3/overview/platforms/#fnref:4) [↩2](https://developer.myscript.com/docs/interactive-ink/1.3/overview/platforms/#fnref:4:1) [↩3](https://developer.myscript.com/docs/interactive-ink/1.3/overview/platforms/#fnref:4:2)
5. 应在 Windows 10 计算机上进行[开发↩](https://developer.myscript.com/docs/interactive-ink/1.3/overview/platforms/#fnref:5)
6. 附带 WPF UI 参考实现[↩](https://developer.myscript.com/docs/interactive-ink/1.3/overview/platforms/#fnref:6)

# 集成级别

在某些情况下，集成 iink SDK 可以像配置视图和向应用程序添加视图一样简单。但是，它有时可能需要更深入的集成。交互式墨迹 SDK 通过支持不同的集成级别提供这种灵活性。

根据具体情况，iink SDK 可以集成在不同的级别：

1. [图形组件](https://developer.myscript.com/docs/interactive-ink/1.3/overview/integration-levels/#graphical-components)
2. [特定于平台的绑定](https://developer.myscript.com/docs/interactive-ink/1.3/overview/integration-levels/#platform-bindings)
3. [跨平台或服务器 API](https://developer.myscript.com/docs/interactive-ink/1.3/overview/integration-levels/#cross-platformserver-apis)

## [图形组件](https://developer.myscript.com/docs/interactive-ink/1.3/overview/integration-levels/#graphical-components)

MyScript 为集成商提供了代码示例和图形组件，以方便 iink SDK 的集成。



此代码在允许的 Apache [2 许可证](https://opensource.org/licenses/Apache-2.0)下发布。这样，您就可以自由地修改它并将其集成到您自己的解决方案中，而无需限制限制。

### [本机平台](https://developer.myscript.com/docs/interactive-ink/1.3/overview/integration-levels/#native-platforms)

示例代码存储库（每个平台一个）提供了有用的**示例**，说明了可以导入到您自己的项目中的 SDK 的一些用法。更重要的是，它附带了目标平台的**参考 UI 实现**，该实现包含一组类，您可以直接重用这些类，以便构建工作基础。

所有代码都依赖于[特定于平台的绑定](https://developer.myscript.com/docs/interactive-ink/1.3/overview/integration-levels/#platform-bindings)，因此可以轻松集成到项目中并根据您的喜好进行调整。

### [Web](https://developer.myscript.com/docs/interactive-ink/1.3/overview/integration-levels/#web)

[文本](https://developer.myscript.com/docs/interactive-ink/1.3/web/web-components/text-element/get-started/)和[数学](https://developer.myscript.com/docs/interactive-ink/1.3/web/web-components/math-element/get-started/) **Web 元素**允许您直接集成到 Web 应用程序中。为了开发您自己的组件，MyScript 还在**[公共元素](https://developer.myscript.com/docs/interactive-ink/1.3/web/web-components/common-element/get-started/)**保护伞下考虑了它们之间的常见部件。

## [平台绑定](https://developer.myscript.com/docs/interactive-ink/1.3/overview/integration-levels/#platform-bindings)

### [本机平台](https://developer.myscript.com/docs/interactive-ink/1.3/overview/integration-levels/#native-platforms-1)

交互式墨迹 SDK 附带适用于 Android、iOS 和 Windows 的平台特定绑定，允许您使用目标平台的主编程语言集成工具包。

绑定提供了灵活的入口点，并提供您可能需要的功能。例如，您可能需要调整提供的 UI 引用实现，甚至开发一个新的 UI 引用实现。如果具有特定要求（例如特定于用例的特定图形工具包或性能优化），则后者可能很有用。

### [Web](https://developer.myscript.com/docs/interactive-ink/1.3/overview/integration-levels/#web-1)

[MyScriptJS](https://developer.myscript.com/docs/interactive-ink/1.3/web/myscriptjs/get-started/)库支持交互式墨迹 SDK，您可以直接使用或调整该库以获得更大的灵活性。



与图形组件和 UI 引用实现一样，MyScriptJS 在允许的[Apache 2 许可证](https://opensource.org/licenses/Apache-2.0)下发布。这样，您就可以自由地修改它并将其集成到您自己的解决方案中，而无需限制限制。

## [跨平台/服务器 API](https://developer.myscript.com/docs/interactive-ink/1.3/overview/integration-levels/#cross-platformserver-apis)

### [本机平台](https://developer.myscript.com/docs/interactive-ink/1.3/overview/integration-levels/#native-platforms-2)

交互式墨迹 SDK 附带一个跨平台C++ API（仅[按需](https://developer.myscript.com/contact-us/on-device-recognition)提供），支持各种平台。

作为通用的非图形 API，它在跨平台开发时非常灵活，但在某些情况下，您可能需要做更多的工作来开发不同的 UI 部件。

### [Web](https://developer.myscript.com/docs/interactive-ink/1.3/overview/integration-levels/#web-2)

Web 平台提供低级[WebSocket](https://developer.myscript.com/docs/interactive-ink/1.3/web/websockets/architecture/)和[REST](https://developer.myscript.com/docs/interactive-ink/1.3/web/rest/architecture/) API，可用于将交互式墨迹集成到本机或 Web 应用程序中。



MyScript 不一定向所有集成商推荐 WebSocket API，因为它需要大量的工作，例如解析 SVG 增量以申请呈现。

# 内容类型

交互式墨迹 SDK 允许您通过统一 API 与不同类型的内容进行一致交互。此页列出了支持的内容类型，并概述了每种类型的潜在特性。

## [通用方法](https://developer.myscript.com/docs/interactive-ink/1.3/overview/content-types/#generic-approach)

交互式墨迹 SDK 提供了一种与所有类型的内容进行交互的通用方式，下图在概念上说明了这一点：

![image-20200415182149414](E:\mypack\工作文件\myscript\开发人员指南.assets\image-20200415182149414.png)

对于每种类型的内容，只要有意义，您可以始终如一：

- 输入数字墨迹并解释，或从[支持的导入格式](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#available-imports)导入数据，
- 显示内容，
- 通过[编辑/修饰手势](https://developer.myscript.com/docs/interactive-ink/1.3/overview/gestures/)与内容互动，
- 将其转换为类型集窗体，
- 保存/加载内容到/从文件系统，
- 从 MyScript 的可读和可解析[交换格式](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/)导出/导入墨迹和解释，并与您的应用程序或生态系统集成，
- 导出到一组内置[支持导出格式](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#available-exports)。

## [受支持的内容类型](https://developer.myscript.com/docs/interactive-ink/1.3/overview/content-types/#supported-content-types)

交互式墨迹 SDK 当前支持以下内容类型：

- **文本**（） - 多行文本的简单块（包括可能的换行符）、响应式重排。默认情况下，它显示参考线，但可以停用这些参考线（例如，处理来自未在参考线上对齐的外部源的墨迹时）。`"Text"`
- **数学**（） - 阻止一个或多个方程。`"Math"`
- **图**（） - 支持图表的块，具有自动文本/非文本区分和动态重组可能性。`"Diagram"`
- **绘图**（） - 阻止托管一些笔画集合，没有任何解释。可用于涂鸦和绘图活动。`"Drawing"`
- **文本文档**（） - 容器托管垂直、动态和响应式内容流中的文本、数学、图表和绘图块的有序集合。`"Text Document"`
- **原始内容**（） - 阻止托管原始数字墨迹，没有显式分割到文本、数学、图表或其他语义由 iink SDK 知道的项目。内容由 iink SDK 进行分析，以从其余内容中检索与文本块对应的墨迹。可通过 JIIX 导出获取此文本/非文本分段。在原始数字墨水上实现墨迹搜索功能是关键。`"Raw Content"`

括号之间提供的字符串值区分**大小写**，以明确的方式标识模型中的类型。



此时，交互式墨迹 SDK 不允许在涉及文本识别时混合语言。

有关 MyScript 技术可以识别的所有类型的内容以及可能的用例的更广泛介绍，请参阅本文档"概念"部分[中的详细演示文稿](https://developer.myscript.com/docs/concepts/content-types/)。

## [平台限制](https://developer.myscript.com/docs/interactive-ink/1.3/overview/content-types/#platform-restrictions)

**绘图和文本文档目前仅受本机平台的支持**。计划为将来的版本提供 Web 支持。

## [有用的链接](https://developer.myscript.com/docs/interactive-ink/1.3/overview/content-types/#useful-links)

- [支持的文本识别语言](https://developer.myscript.com/docs/interactive-ink/1.3/overview/text-languages/)
- [支持的数学符号和规则](https://developer.myscript.com/docs/interactive-ink/1.3/overview/math-elements-and-rules/)
- [支持的关系图形状](https://developer.myscript.com/docs/interactive-ink/1.3/overview/diagram-features/)
- [支持按内容类型编辑/修饰手势](https://developer.myscript.com/docs/interactive-ink/1.3/overview/gestures/)
- [支持每个内容类型的导入/导出](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/)

# 编辑手势

交互式墨迹 SDK 支持各种编辑和修饰手势。

支持的[手势](https://developer.myscript.com/docs/concepts/editing-gestures/)取决于[内容的类型](https://developer.myscript.com/docs/interactive-ink/1.3/overview/content-types/)。可能性由下表汇总：

| Content type         | Text Document | Text | Diagram | Math | Drawing | Raw Content |
| :------------------- | :-----------: | :--: | :-----: | :--: | :-----: | :---------: |
| **Erase**            |       X       |  X   |    X    |  X   |         |             |
| **Join**             |       X       |  X   |    X    |      |         |             |
| **Break**            |       X       |  X   |    X    |      |         |             |
| **Frame**            |       X       |  X   |         |      |         |             |
| **Underline**        |       X       |  X   |         |      |         |             |
| **Double underline** |       X       |  X   |         |      |         |             |

# 导入和导出格式

此页列出可用的导入和导出格式，具体取决于要考虑的块。有关进一步说明，请参阅指南的导入/导出部分。

## [可用导出](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#available-exports)

- **文本块：** [JIIX，](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/)原始文本， 多cx[1](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:1) [2](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:2)Html[1](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:1)Png[2](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:2)Jpeg[2](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:2)
- **数学块：** [JIIX，](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/)LaTeX， MathML， 多cx[1](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:1) [2](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:2)Html[1](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:1)Png[2](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:2)Jpeg[2](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:2)
- **图块：** [JIIX](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/)， SVG， 图形ML， pptx[3](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:3)， 多Cx[1](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:1) [2](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:2)，微软办公室剪贴板格式[4](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:4)Html[1](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:1)Png[2](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:2)Jpeg[2](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:2)
- **绘图块：** [JIIX](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/)， PNG[2](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:2)Jpeg[2](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:2)
- **文本文档：** [JIIX](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/)， 原始文本， 多cx， HTML， PNG[2](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:2)Jpeg[2](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:2)
- **原始内容：** [JIIX](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/)， PNG[2](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:2)Jpeg[2](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:2)

## [可用导入](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#available-imports)

- **文本块：** [JIIX](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/)[5](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:5)，原始文本
- **数学块：** [JIIX](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/)
- **图表块**[：JIIX](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/)[5](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:5)
- **文本文档：** [JIIX](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/)[5](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:5)，原始文本[6](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fn:6)

1. 仅为 Web 平台直接导出。本机平台需要将零件粘贴到中间的"文本文档"部分才能获得此结果。[↩](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:1) [↩2](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:1:1) [↩3](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:1:2) [↩4](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:1:3) [↩5](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:1:4) [↩6](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:1:5)
2. 对于本机平台，需要向导出方法提供 。[↩](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:2)`ImageDrawer` [↩2](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:2:1) [↩3](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:2:2) [↩4](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:2:3) [↩5](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:2:4) [↩6](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:2:5) [↩7](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:2:6) [↩8](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:2:7) [↩9](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:2:8) [↩10](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:2:9) [↩11](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:2:10) [↩12](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:2:11) [↩13](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:2:12) [↩14](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:2:13) [↩15](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:2:14)
3. 图表内容将以转换形式导出。[↩](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:3)
4. 保存在您定义的位置作为文件保存。由**您**使用该键将其放入剪贴板。另请注意，Microsoft Office 不支持在所有平台上粘贴系统剪贴板中的内容。[↩](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:4)`Art::GVML ClipFormat`
5. 目前，JIIX导入的文本内容只能用于选择识别的文本单词候选项，[如此处](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/#jiix-import)所述。[↩](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:5) [↩2](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:5:1) [↩3](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:5:2)
6. 原始文本导入到"文本文档"与方法，如[此处](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#block-addition)所述。[↩](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/#fnref:6)`addBlock`

# 数学解算器

交互式墨迹 SDK 不仅可以识别方程，还可以求解方程！

MyScript 数学是一个算术解算器，可在以下条件下求解输入方程：

- 方程必须包含数字和/或分数，并且至少包含以下运算符或常量之一：

![img](https://developer.myscript.com/docs/images/maw-tutorial-symbols.png)

- 可以求解具有一个未知值的方程，**但**变量必须用问号而不是字母突出显示。
  *示例："4y = 2 = 24"不会求解，而"4 = ？= 2 = 24"将。*
- 可以识别和设置具有多个未知数的方程，但不能求解。

要查看受支持的符号、规则和操作的完整列表，[请阅读本节](https://developer.myscript.com/docs/interactive-ink/1.3/overview/math-elements-and-rules/)。

## [手动或自动解算器](https://developer.myscript.com/docs/interactive-ink/1.3/overview/math-solver/#manual-or-automatic-solver)

您可以选择添加按钮，以便用户手动激活解算器，也可以让应用自动求解每个支持的方程。只需[选择](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/#math)更适合您的用例！

## [显示功能](https://developer.myscript.com/docs/interactive-ink/1.3/overview/math-solver/#display-features)

[您可以选择角度](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/#math)单位（度或半径）、要显示的小数数以及是希望结果是四舍五入还是截断。

# 文本语言

交互式墨迹 SDK 可以识别广泛的语言和文本功能。

## [语言](https://developer.myscript.com/docs/interactive-ink/1.3/overview/text-languages/#languages)

- 南非 - 南非
- 阿尔巴尼亚语 - 阿尔巴尼亚
- 亚美尼亚语 - 亚美尼亚
- 阿塞拜疆 - 阿塞拜疆[1](https://developer.myscript.com/docs/interactive-ink/1.3/overview/text-languages/#fn:1)
- 巴斯克语 - 西班牙
- 白俄罗斯语 - 白俄罗斯
- 波斯尼亚语 - 波斯尼亚语
- 保加利亚语 - 保加利亚
- 加泰罗尼亚语 - 西班牙
- 宿务 - 菲律宾
- 中文简体 - 中国
- 中国传统 - 香港
- 中国传统 - 台湾
- 克罗地亚语 - 克罗地亚
- 捷克 - 捷克共和国
- 丹麦语 - 丹麦
- 荷兰语 - 荷兰
- 英语 - 加拿大
- 英语 - 菲律宾
- 英语 - 英国
- 英语 - 美国
- 爱沙尼亚语 - 爱沙尼亚
- 菲律宾语 - 菲律宾
- 芬兰语 - 芬兰
- 荷兰语 - 比利时[2](https://developer.myscript.com/docs/interactive-ink/1.3/overview/text-languages/#fn:2)
- 法语 - 加拿大
- 法语 - 法国
- 爱尔兰语 - 爱尔兰[3](https://developer.myscript.com/docs/interactive-ink/1.3/overview/text-languages/#fn:3)
- 加利西亚语 - 西班牙
- 格鲁吉亚语 - 格鲁吉亚
- 德语 - 奥地利
- 德语 - 德国
- 希腊语 - 希腊
- 匈牙利语 - 匈牙利
- 冰岛语 - 冰岛
- 印度尼西亚语 - 印度尼西亚
- 意大利语 - 意大利
- 日语 - 日本
- 哈萨克语 - 哈萨克斯坦
- 韩语 - 韩国
- 拉脱维亚语 - 拉脱维亚
- 立陶宛语 - 立陶宛
- 马其顿语 - 马其顿
- 马达加斯加 - 马达加斯加
- 马来语 - 马来西亚
- 蒙古语 - 蒙古语
- 挪威语 - 挪威
- 波兰语 - 波兰
- 葡萄牙语 - 巴西
- 葡萄牙语 - 葡萄牙
- 罗马尼亚语 - 罗马尼亚
- 俄语 - 俄罗斯
- 塞尔维亚语 （西里尔语） - 塞尔维亚
- 塞尔维亚语（拉丁语） - 塞尔维亚
- 斯洛伐克语 - 斯洛伐克
- 斯洛文尼亚语 - 斯洛文尼亚
- 西班牙语 - 哥伦比亚
- 西班牙语 - 墨西哥
- 西班牙语 - 西班牙
- 斯瓦希里语 - 坦桑尼亚
- 瑞典语 - 瑞典
- 塔塔尔语 - 俄罗斯
- 土耳其语 - 土耳其语
- 乌克兰语 - 乌克兰语
- 越南语 - 越南

## [显著的识别功能](https://developer.myscript.com/docs/interactive-ink/1.3/overview/text-languages/#notable-recognition-features)

- **6个基本表情符号**可以识别为文本的一部分，以及共有16个变体[作为文本候选项](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/text-recognition-candidates/)：
  - ❤（变体：💓、💙、💕）
  - 💔（变体：💘）
  - 😐（变体：😒、😓）
  - ☺（变体：😁、😃、😍、😄、😊）
  - ☹（变体：😞、😭、😠、😩）
  - 😉（变体：😜）
- **带圆圈的数字：** （1） （2） （3） （4） （5） （6） （7） （8） （9）

1. 也称为阿塞拜疆。[↩](https://developer.myscript.com/docs/interactive-ink/1.3/overview/text-languages/#fnref:1)
2. 也称为佛兰芒语。[↩](https://developer.myscript.com/docs/interactive-ink/1.3/overview/text-languages/#fnref:2)
3. 也称为盖尔语。[↩](https://developer.myscript.com/docs/interactive-ink/1.3/overview/text-languages/#fnref:3)

# 数学元素和规则

交互式墨迹 SDK 可以识别以下数学元素和规则。

## [元素](https://developer.myscript.com/docs/interactive-ink/1.3/overview/math-elements-and-rules/#elements)

| Type                                                         | Items                                                        |
| :----------------------------------------------------------- | :----------------------------------------------------------- |
| Letters (Latin alphabet)                                     | a b c d e f g h i j k l m n o p q r s t u v w x y z A B C D E F G H I J K L M N O P Q R S T U V W X Y Z |
| Digits                                                       | 0 1 2 3 4 5 6 7 8 9                                          |
| Mathematical symbols (including operators)                   | € $ £ ¥ ₩ ¢ ( ) [ ] { } ! # % ‰ & ? @ / \ \| ∥ ∦ © ∂ ∅ ∇ ∞ + - ± × ÷ * √ ¬ ∘ · ‘ , . : ; _ ← ↑ → ↓ ↔ ↕︎ ↖︎ ↗︎ ↘︎ ↙︎ ↼ ⇀ ↽ ⇁ ⇋ ⇌ ⇐ ⇑ ⇒ ⇓ ⇔ ⇕ ∀ ∃ ∄ ∈ ∉ ∋ ∌ ∪ ∩ ⊂ ⊃ ⊄ ⊅ ⊆ ⊈ ⊇ ⊉ ∝ ∏ ∐︎ ∑ ∫ ∬ ∭ ∮ ∯ ∰ ℂ ℕ ℚ ℝ ℤ 𝔻 ℑ︎ ℜ︎ = ≠ ≒ ≡ ≢ ∼ ≃ ≄ ≅ ≆ ≇ ≈ ≉ < > ∧ ∨ ≤ ≥ ≮︎ ≯︎ ≰︎ ≱︎ ≪ ≫ ⋉ ⋊ ⋮ … ⋱ ⋰ ⌈ ⌉ ⌊ ⌋ □ △ ⟦ ⟧ ∠ ⦞ ℏ ⊥ ⫻ ⊕ ⊗ ⊖ ⊙ ∓ ∵ ∴ ≦ ≧ ℱ ℒ ⌒ |
| Greek symbols frequently used in mathematics                 | Γ Δ Θ Λ Ξ Π Σ Υ Φ Ψ Ω α β γ δ ε ζ η θ ι κ λ µ ν ξ π ρ σ τ υ φ ϕ χ ψ ω |
| Mathematical terms                                           | sin cos tan sinh cosh tanh arcsin arccos arctan cot coth min max arg argmin argmax csc deg det dim exp gcd hom inf sup lg ker lim liminf limsup ln log dx dy dz dt rad mol angle bessel mean median mod norm ceil conv cov diag erf fft floor Im Re inv perms pinv rand round sign size sort sqrt svd var |
| Chemical elements                                            | He Li Be Ne Na Mg Al Si Cl Ar Ca Sc Ti Cr Mn Fe Co Ni Cu Zn Ga Ge As Se Br Kr Rb Sr Zr Nb Mo Tc Ru Rh Pd Ag Cd In Sn Sb Te Xe Cs Ba Hf Ta Re Os Ir Pt Au Hg Tl Pb Bi Po At Rn Fr Ra Rf Db Sg Bh Hs Mt Ds Rg Cn Uut Uuq Uup Uuh Uus Uuo La Ce Pr Nd Pm Sm Eu Gd Tb Dy Ho Er Tm Yb Lu Ac Th Pa Np Pu Am Cm Bk Cf Es Fm Md No Lr |
| International convention units (weight, length, frequency, luminosity, dosage, pressure, etc.) | km hm dam m dm cm mm µm nm pm fm ha in ft mi yd yds oz lb lbs dl cl ml µl kg hg dag dg cg mg µg ng pg ds cs ms µs gon tex Pr ua ha rad tr Hg sec amp div rot abs ns ps fs Pt Tt Gt Mt kt PHz THz GHz MHz kHz hHz daHz Hz dHz cHz mHz µHz nHz pHz fHz PN TN GN MN kN hN daN dN cN mN µN nN pN fN PNm TNm GNm MNm kNm hNm daNm dNm cNm mNm µNm nNm pNm fNm PJ TJ GJ MJ kJ hJ daJ dJ cJ mJ µJ nJ pJ fJ PW TW GW MW kW hW daW dW cW mW µW nW pW fW PWh TWh GWh MWh kWh hWh daWh Wh dWh cWh mWh µWh nWh pWh fWh PeV TeV GeV MeV keV heV daeV eV deV ceV meV µeV neV peV feV PPa TPa GPa MPa kPa hPa daPa Pa dPa cPa mPa µPa nPa pPa fPa Pbar Tbar Gbar Mbar kbar hbar dabar bar dbar cbar mbar µbar nbar pbar fbar PA TA GA MA kA mA µA nA pA fA PV TV GV MV kV mV µV nV pV fV PS TS GS MS kS mS µS nS pS fS PC TC GC MC kC mC µC nC pC fC PAh TAh GAh MAh kAh mAh µAh nAh pAh fAh PF TF GF MF kF mF µF nF pF fF PH TH GH MH kH mH µH nH pH fH PWb TWb GWb MWb kWb mWb µWb nWb pWb fWb PT TT GT MT kT mT µT nT pT fT PBq TBq GBq MBq kBq hBq daBq Bq dBq cBq mBq µBq nBq pBq fBq PGy TGy GGy MGy kGy hGy daGy Gy dGy cGy mGy µGy nGy pGy fGy PSv TSv GSv MSv kSv hSv daSv Sv dSv cSv mSv µSv nSv pSv fSv Pcd Tcd Gcd Mcd kcd hcd dacd cd dcd ccd mcd µcd ncd pcd fcd Plm Tlm Glm Mlm klm hlm dalm lm dlm clm mlm µlm nlm plm flm Plx Tlx Glx Mlx klx hlx dalx lx dlx clx mlx µlx nlx plx flx parsec |

## [规则](https://developer.myscript.com/docs/interactive-ink/1.3/overview/math-elements-and-rules/#rules)

![image-20200415182519883](E:\mypack\工作文件\myscript\开发人员指南.assets\image-20200415182519883.png)
![image-20200415182608912](E:\mypack\工作文件\myscript\开发人员指南.assets\image-20200415182608912.png)
![image-20200415182629268](E:\mypack\工作文件\myscript\开发人员指南.assets\image-20200415182629268.png)

# 图表功能

下面是支持的形状的列表：

![image-20200415182721999](E:\mypack\工作文件\myscript\开发人员指南.assets\image-20200415182721999.png)

## [连接](https://developer.myscript.com/docs/interactive-ink/1.3/overview/diagram-features/#connections)

形状、连接符和文本可以轻松链接。一旦两个项目链接，移动/调整一个项目大小意味着相应地移动/调整另一个项目。

- 在形状内写入文本以链接两者：

![img](https://developer.myscript.com/docs/images/diw-connection1.png)

- 在连接符旁边写入文本以链接这两个：

![img](https://developer.myscript.com/docs/images/diw-connection3.png)

- 在两个形状之间绘制连接线以链接它们：

![img](https://developer.myscript.com/docs/images/diw-connection2.png)

- 将两个连接器彼此靠近以链接：

![img](https://developer.myscript.com/docs/images/diw-connection4.png)

- 标记连接器以链接两者：

![img](https://developer.myscript.com/docs/images/diw-connection5.png)

如下图所示：

- 当文本写入形状时，连接符链接到形状，而不是文本。
- 如果没有形状，连接器将链接到文本。

![img](https://developer.myscript.com/docs/images/diw-connection.png)

当两个元素由连接器链接时，它被称为"节点"。节点可以是形状、某些文本，也可以是自由绘图。

当用户将唯一且居中的文本放在形状中时，它被称为"单元格标签"。如果文本放置在连接器附近，则称为"标签"。

# 开始

交互式墨迹 SDK 便于入门。此页面可帮助您设置开发环境、获取证书并播放提供的示例应用程序。

## [设置开发环境](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/get-started/#setting-up-a-development-environment)

要使用适用于 Android 的 iink SDK 进行开发，您需要：

- [安卓工作室](https://developer.android.com/studio/index.html)2.3.3 或更高版本
- Android SDK API 26 及更高版本（即使库使用 Android SDK API 21 及更高版本运行）
- [Git（](https://git-scm.com/)用于克隆 GitHub 示例存储库）

## [应用程序示例](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/get-started/#example-applications)

MyScript iink SDK 附带了说明如何使用密钥 API 的示例应用程序。

该代码在[GitHub](https://github.com/myscript/interactive-ink-examples-android)上可用。



自定义编译步骤将下载示例运行所需的最小识别资产集。更多资产（例如支持其他识别语言）可以从[MyScript 开发人员门户](https://developer.myscript.com/support/recognition-assets)下载。

有关示例，请参阅特定于平台的集成层的参考实现。它涵盖了以下方面，例如[渲染](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/)低级 iink SDK 不提供开箱即用的灵活和可移植性原因。

示例和引用实现的源代码在[Apache 2.0 许可证](https://opensource.org/licenses/Apache-2.0)下发布。您可以重用它到您自己的项目中，而不受任何特定限制。

## [获取证书](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/get-started/#getting-a-certificate)

证书是 MyScript 提供的二进制"密钥"，在应用程序中启用 iink SDK**需要**：

- 如果您刚刚在[MyScript 开发人员门户](https://developer.myscript.com/)注册 ，您应该已经收到一个证书通过邮件，将让你运行提供的**入门示例**。
- 如果没有 - 或激活 iink SDK 与您自己的应用程序 - 请按照[设备上的许可证管理](https://developer.myscript.com/support/account/on-device-license-management/)说明。



开发人员门户证书是为每个应用标识符专门生成的。您不能直接在您自己的应用程序中重用"入门"证书。

证书嵌入到应包含在项目中的**源文件中**：

- MyScript 提供的示例预计它位于特定位置（请参阅下面的说明）。
- 对于您自己的应用程序，您可以将其放置在所需的位置，前提是它可以实例[化 iink 运行时](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/#engine-creation)。

有关证书和许可证管理的更多详细信息，请参阅[专用支持部分](https://developer.myscript.com/support/account/on-device-license-management/)。

## [使用入门示例播放](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/get-started/#playing-with-the-get-started-example)

入门示例是首次接触 iink SDK API 的最简单方法。

要运行它，只需按照以下说明操作：

**第 1 步：**克隆包含 Android 平台示例的 MyScript Git 存储库，并导航到包含应用程序的文件夹的根目录：

```plaintext
git clone https://github.com/MyScript/interactive-ink-examples-android.git
cd interactive-ink-examples-android
```

**第 2 步：**将目录中的文件替换为[证书](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/get-started/#getting-a-certificate)。`MyCertificate.java``GetStarted/src/main/java/com/myscript/certificate`

**第 3 步：**将目录作为现有的 Android 工作室项目打开。应抓住 Gradle 依赖项，并且项目应成功编译。`interactive-ink-examples-android`

**第 4 步：**运行目标。`GetStarted`

## [构建第一个交互式墨迹应用程序](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/get-started/#building-your-first-interactive-ink-application)

为了指导您了解交互式墨迹 SDK 的基本原理，假设您想要构建一个（非常）简单的手写计算器。本指南介绍了一些关键概念，并为您提供了与简单 iink SDK 集成相关的代码部分。



由于大多数 iink API 与您操作的内容类型（文本、数学、图表等）无关，因此代码可以轻松适应其他用例。

为了此示例，此类应用程序将为最终用户提供：

- 写入计算的写作区域，
- 要撤消、重做和清除画布的按钮，
- 一个验证按钮，用于将内容转换为类型集窗体并执行计算，
- 过去计算的历史，
- 跨会话的持久性，
- 默认情况下，iink SDK 提供的某些自定义样式。



本指南假定所有与 iink 相关的代码都是单个类的一部分。`Calculator`

本指南包括以下步骤：

1. [交互式墨迹运行时](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/)
2. [存储](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/)
3. [渲染](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/)
4. [编辑](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/)
5. [转换](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/conversion/)
6. [进出口](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/)
7. [缩放和滚动](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/zooming-and-scrolling/)
8. [造型](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/styling/)
9. [错误管理](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/error-management/)



在以逻辑方式逐个介绍不同概念时，本指南的编写方式允许您随时引用特定方面，即使您没有严格遵守预期的顺序。

准备？[我们开始吧！](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/)

# 交互式墨迹运行时

本页演示如何实例化 iink 运行时并对其进行配置以满足您的需要。

## [发动机创建](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/#engine-creation)

iink SDK 运行时由对象表示。`Engine`

此对象将允许您创建其他关键对象、配置识别并微调 SDK 行为。

它通过类的静态方法实例化：`create()``Engine`

在 java 中，我们强烈建议将引擎创建包装成单例。

```java
import com.myscript.certificate.MyCertificate;
import com.myscript.iink.Engine;

public class IInkApplication extends Application
{
  private static Engine engine;

  public static synchronized Engine getEngine()
  {
    if (engine == null)
    {
      engine = Engine.create(MyCertificate.getBytes());
    }

    return engine;
  }
}
```



参数中提供的数据对应于您的[激活证书](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/get-started/#getting-a-certificate)。如果引擎创建失败，请确保它是为应用程序标识符生成的。

## [对象生命周期](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/#objects-lifecycle)

在关闭应用程序或打开新包之前，请确保首先释放对相应对象的所有引用。如果没有，则可能会遇到意外行为，因为仍分配本机资源。

此资源管理必须应用于实现接口的所有对象：[内容包](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#structure-of-the-model)、[内容部分](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#structure-of-the-model)、[编辑器](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/)、[引擎](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/#engine-creation)、[参数集](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/#reading-and-writing-configuration-parameters)、[识别资产生成器](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/build-custom-resources/#on-device)和[呈现器](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/#renderer)。`IAutoCloseable`

要强制立即释放本机资源，必须显式调用相应对象的方法。确保不要通过将引用设置为 null 来引用它们。`close`

例如：

```java
// close contentPart and set its reference to null
if (contentPart != null)
{
  contentPart.close();
  contentPart = null;
}

// then close contentPackage and set its reference to null
if (contentPackage != null)
{
  contentPackage.close();
  contentPackage = null;
}
```

## [配置](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/#configuration)

**必须配置**新引擎，让 iink SDK 知道要识别哪些内容。

Being a flexible toolkit, iink SDK also comes with many configuration parameters. While the default values make sense in most cases, it may sometimes be required to configure them to suit your needs.

### [Accessing the configuration](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/#accessing-the-configuration)

The configuration can be obtained by calling on the engine object.`getConfiguration()`

It is possible to attach a listener implementing the interface to a given configuration object to get notified when configuration changes are made.`IConfigurationListener`

### [Configuring the recognition](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/#configuring-the-recognition)

To recognize math, diagrams or text in any language, the engine needs to be created and pointed to the required assets.

Assets packages consist in a set of **configuration files** () that specify required recognition parameters combined to binary files called **resources files** (). The resources files host everything that the engine requires for the recognition.`*.conf``*.res`

交互式墨迹 SDK 默认配置应适合大多数需求。所以在大多数情况下，你不必关心他们。如果需要更进一步，可以[了解如何修改或编写自己的配置文件](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/)（高级）。



请确保在应用程序上正确部署这些文件。一种好的做法是在[编辑器级别实现错误管理](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#monitoring-changes-in-the-model)，以便通知识别配置错误。

### [语言识别配置](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/#language-recognition-configuration)

文本识别的默认语言是*英语en_US。*因此，您可能想要做的第一个识别调优是修改语言。



MyScript 语言名称以双字母语言代码开头（使用[ISO-639 标准](https://www.iso.org/iso-639-language-codes.html)），后跟下划线和两个字母的国家/地区代码（使用[ISO-3166 标准](https://www.iso.org/iso-3166-country-codes.html)）。例如*，美国英语en_US。*

MyScript 提供了一些随时可以使用语言包，因此更新语言是一项简单的任务，只需几个步骤即可执行：

**步骤 1**下载相应的语言包，因此在我们的示例中，选择意大利语[：MyScript 开发人员门户](https://developer.myscript.com/support/recognition-assets)上提供了其他语言或内容类型的包。

**步骤 2**在应用程序项目中安装包：语言包包含一个存档，其中包含要在项目路径中提取的**配置文件**（） 和相关**资源文件**（）。`*.zip``*.conf``*.res`



确保正确部署这些文件，因为 .conf 文件引用具有相对路径的 .res 文件。因此，在提取文件时，请小心保留存档文件夹结构

**步骤 3**在应用程序代码中修改引擎配置语言：

- 将密钥的值设置为包含语言配置文件 （_.conf） 的文件夹。`configuration-manager.search-path`
- 设置键的值以匹配您的语言`lang`

例如，为意大利语设置，因为相应的资源在 中描述：`it_IT``it_IT.conf`

```java
import com.myscript.iink.Configuration;
import com.myscript.iink.Engine;
import java.io.File;

...
Engine engine = IInkApplication.getEngine();

// configure recognition
Configuration conf = engine.getConfiguration();
conf.setStringArray("configuration-manager.search-path", new String[] { "zip://" + getPackageCodePath() + "!/assets/conf" });
conf.setString("lang", "it_IT");
```

### [特定于内容的配置](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/#content-specific-configuration)

交互式墨迹 SDK 具有许多配置选项。有些是常规的，例如选择[临时文件夹](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#temporary-folder)的位置来在文件系统上存储工作数据，有些取决于您操作的内容类型。例如，可以激活或停用数学方程的解算器。

支持的配置选项的完整列表可以在[专用部分](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)中找到。

### [编辑器级配置](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/#editor-level-configuration)

引擎级配置对应于默认的全局配置。可以在[编辑器级别](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#editor-level-configuration)重写配置值，如果管理具有不同配置的多个部件，则这非常有用。

### [读取和写入配置参数](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/#reading-and-writing-configuration-parameters)

交互式墨迹 SDK 配置是一个对象。它可以被看作是一组键/值对，其中值本身可以是其他对象。`ParameterSet``ParameterSet`

您可以读取附加到现有键的值、添加新（键、值）对或删除现有键。支持的值类型包括字符串、数字、布尔、字符串数组以及其他对象。`ParameterSet`

下面是此类结构的表示形式：

```javascript
{
  "name": "iink SDK",
  "interactive": true,
  "version":
  {
    "major": 1,
    "minor": 0
  },
  "parts": [ "Text", "Math", "Diagram", "Drawing", "Raw Content", "Text Document"]
}
```

下面的代码显示了在变量中存储时如何操作此结构：`parameters`

```java
import com.myscript.iink.ParameterSet;

// Access a section content
ParameterSet version = parameters.getSection("version");

// Read a value for a key using the section object
Number major = version.getNumber("major"); // -> 1

// Set a value for a key using the dot syntax
parameters.setNumber("version.major", major + 1); // -> 2
```

## [返回示例](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/#back-to-the-example)

为了能够识别数学，需要创建示例计算器的引擎并指向所需的资产。简单的方法是依赖数学的默认配置：您只需将正确的配置选项设置为 iink SDK 提供的文件所在的文件夹。`math.conf`

此外，建议提供有效的配置，[在下一步](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#temporary-folder)中进一步说明。`content-package.temp-folder`

需要启用数学后端的解算器组件，以便在执行转换时可以处理计算。默认情况下，值为 ，因此此处无事可做。`math.solver.enable``true`

最后，为了该示例，您可以将答案的浮点精度更改为 2 位（默认情况下为 3）。

因此，创建和配置引擎的代码将是：

```java
import com.myscript.iink.Configuration;
import com.myscript.iink.Engine;
import java.io.File;

public class Calculator
{

  private Engine engine;

  /**
   * @param packageCodePath when used from an AppCompatActivity object, getPackageCodePath() output.
   * @param filesDirPath when used from an AppCompatActivity object, getFilesDir().getPath() output.
   */
  public Calculator(String packageCodePath, String filesDirPath)
  {

    //Creating engine and accessing the configuration object
    engine = IInkApplication.getEngine();
    Configuration configuration = engine.getConfiguration();

    // set the recognition configuration
    configuration.setStringArray("configuration-manager.search-path", new String[]{"zip://" + packageCodePath + "!/assets/conf"});

    // set the temporary directory
    String tempDir = filesDirPath + File.separator + "tmp";
    configuration.setString("content-package.temp-folder", tempDir);

    // set the math fractional part precision
    configuration.setNumber("math.solver.fractional-part-digits", 2);
  }
}
```

在这一点上，引擎是理论上能够识别数学。本指南[的下一步](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#structure-of-the-model)将演示如何加载和保存内容。

## [有用的链接](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/#useful-links)

- [获取证书](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/get-started/#getting-a-certificate)
- [配置参考](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)
- [自定义识别](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/)（高级）

# 存储

本页说明 iink SDK 如何允许您组织其工作的数据、存储内容并在以后再次加载它。

## [模型的结构](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#structure-of-the-model)

交互式墨迹 SDK 使用以下结构存储内容：

- `ContentPackage`-**包装**是存储墨水的容器，其解释是有序的**零件**集合。它可以作为文件[保存在](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#saving-packages)文件系统上，并在用户之间重新加载或共享。
- `ContentPart`-**部件**对应于一*个独立的*内容单元，该单元可以由 iink SDK 处理。每个部分都有**一个特定的类型**，对应于其[根块](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#block-management)的类型，可以通过其方法检索。`getType()`



支持零件类型的完整列表[可在此处](https://developer.myscript.com/docs/interactive-ink/1.3/overview/content-types/)找到。

可以通过调用和访问单个部件来获取给定包的份量，并传递要加载的零件的 0 索引。`getPartCount()``getPart()`

部件承载数据 iink SDK 工作。因此，即使您不打算将数据保留在磁盘上作为应用程序工作流的一部分，也需要使用它们。



尽管内容部分有时承载单个[内容块](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#block-management)，但两个概念并不等效。零件对应于*序列化*单元，而块对应于可以操作的*语义*单元。

## [使用包](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#working-with-packages)

交互式墨迹 SDK 使用文件系统来限制给定时间点所需的 RAM 量，以及存储临时文件。它还提供序列化/反序列化方法，让应用程序保存/加载 MyScript 数据，以满足持久性需求或用户之间交换数据。



MyScript iink SDK 序列化格式针对速度和紧凑性进行了优化，但不易读取。如果要分析交互式模型的内容，请参阅[导入/导出部分](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/)。

### [临时文件夹](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#temporary-folder)

即使您不打算显式[保存](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#saving-packages)任何内容，MyScript iink SDK 也需要对文件系统上至少一个文件夹的读/写访问：**临时文件夹**，它将输出正在处理的中间文件。

默认情况下，iink SDK 使用包文件所在的文件夹。但是，选择另一个文件夹可能相关（甚至在某些平台上是强制性的）。这可以通过在发动机配置中[设置 的值](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/#reading-and-writing-configuration-parameters)来实现。`content-package.temp-folder`



如果不存在，则如果[保存](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#saving-packages)相应的包，将创建该文件夹。它还可能由 iink SDK 自动创建，以防需要减少其内存使用量或处理某些特定对象（如图像）时。

### [创建和加载包](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#creating-and-loading-packages)

要创建或打开包，请使用 方法。它具有不同的可能选项：`openPackage()`

- `EXISTING`打开现有包，如果不存在（默认行为），则失败。
- `CREATE`打开现有包，如果不存在，则将其创建。
- `CREATE_NEW`以确保创建和打开以前不存在的包。
- `TRUNCATE_EXISTING`创建并打开新包，覆盖同一位置的任何预先存在的包。

要创建新包，可以交替调用方便方法，该方法等效于使用 选项进行调用。`createPackage()``openPackage()``CREATE_NEW`

这两种方法都采用与文件系统上的包对应的文件名称作为第一个参数。

```java
import com.myscript.iink.ContentPackage;

// Create a new package
ContentPackage contentPackage = engine.createPackage(newContentPackageFile);

// Load an existing package
ContentPackage existingPackage = engine.openPackage(existingContentPackageFile);
```

### [保存包](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#saving-packages)

交互式墨迹 SDK 提供了两种不同的方法来保存内容：和 ，都调用实例以供考虑。`save()``saveToTemp()``ContentPackage`

了解它们之间的区别非常重要，因为它们扮演着不同的角色：

- `save()`会将所有数据序列化到以包命名的 zip 存档中，无论此类数据是否位于内存中，还是已卸载到临时文件夹中。生成的文件是自包含的，可以在以后重新加载。由于压缩，此方法相当慢。
- `saveToTemp()`将加载到内存中的内容保存到临时文件夹。由于它只在给定时间点写入内存中的内容，并且不需要压缩，因此调用此方法要快得多。如果 iink SDK 被迫退出而不保存到压缩存档，它可以让 iink SDK 恢复这些数据。

下图说明了 iink SDK 如何管理内存，以及不同保存操作的作用：

内容包"内容.iink"（在 RAM 中）内容.iink（zip 存档）临时文件夹内容.iink 文件片段 1fragment 2fragment 3第一次"保存"创建存档和提交内容"打开"部分提取"保存到"卸载内存<自动>部分提取<自动>部分负载或卸载"保存"提交更改



默认情况下，与内容包对应的数据通过附加后缀并位于同一文件夹中存储在以此包命名的文件夹中。`-files`

### [删除包](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#deleting-packages)

使用 方法从磁盘中删除现有包。请确保首先释放对此包的所有引用，包括通过显式调用其各自方法打开的部分。`deletePackage()``close()`

## [使用零件](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#working-with-parts)

零件从其父包创建和操作。

### [创建零件](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#creating-parts)

要创建零件，请调用父包，并传递给它一个与要分配给其[根块](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#block-management)[的内容类型对应的](https://developer.myscript.com/docs/interactive-ink/1.3/overview/content-types/)字符串（之后无法更改）。`createPart()`

可能的选项是当前"文本"、"数学"、"绘图"、"图表"、"原始内容"或"文本文档"（区分大小写）。

要从现有包复制零件，请调用**目标**包（如果只想复制零件，则停靠该包与源包相同），并将其传递给要复制的零件的指针。`clonePart()`

要将部件从包*"移动到"*另一个包，请先将其克隆到新包中，然后从原始包[中删除](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#deleting-parts)该部件。

### [打开部件](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#opening-parts)

要打开零件，请调用并传递参数其索引在其父包中（索引从 0 开始）。可以通过调用给定包的方法检索给定包的份量。`getPart()``getPartCount()`

### [删除零件](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#deleting-parts)

要删除部件，请调用其父包。`removePart()`

## [元](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#metadata)

您可以将元数据附加到和对象，并且它们将与文件一起序列化。这对于存储特定于客户端的参数非常有用。`ContentPart``ContentPackage`

使用 并分别存储和检索附加到对象的元数据。`setMetadata()``getMetadata()`

```java
// Retrieve the metadata from a part
ParameterSet metadata = contentPart.getMetadata();

// Set and Get (key, value) pairs
// ...

// Store the metadata back into the part. You have to set expressively as the content part is a native object and metada is not.
contentPart.setMetadata(metadata);
```

表示元数据的结构为 ，并且操作方式与引擎配置参数[完全相同](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/#reading-and-writing-configuration-parameters)。`ParameterSet`

## [返回示例](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#back-to-the-example)

计算器需要设置一个包，iink SDK 可用于存储其正在处理的内容。

此外，如果用户退出并重新启动应用，则需要能够还原上一个会话的状态。这在 Android 等系统上也很有用，在系统中应*保存内容，然后在*旋转屏幕时还原内容。

```java
import com.myscript.iink.ContentPackage;
import com.myscript.iink.ContentPart;

...

private ContentPart contentPart;
private ContentPackage contentPackage;
private String packageName = "calculator.iink";

public void saveContent() throws IOException
{
  // Save history in part metadata
  saveHistory();
  // Save the content package to the file system
  contentPackage.save();
}

public void openContent() throws IOException
{
  File packageNameFile = new File(packageName);
  if (packageNameFile.exists())
  {
    contentPackage = engine.openPackage(packageNameFile);
    contentPart = contentPackage.getPart(0);
    // Load history from part metadata
    loadHistory();
  }
  else
  {
    // Create a content package to provide the SDK with a place to work
    contentPackage = engine.createPackage(packageNameFile);
    // Create a Math part
    contentPart = contentPackage.createPart("Math");
  }
}
```

You can make sure to call after launching the app to always have a package to work on.`openContent()`

You can also use metadata to store the history (an array of LaTeX strings):

```java
private List<String> history;

public void loadHistory()
{
  ParameterSet parameterSet = contentPart.getMetadata();
  history = Arrays.asList(parameterSet.getStringArray("history"));
}

public void saveHistory()
{
  ParameterSet parameterSet = contentPart.getMetadata();
  parameterSet.setStringArray("history", history.toArray(new String[history.size()]));
  //As contentPart is a native object you have to explicitly set the attribute
  contentPart.setMetadata(parameterSet);
}
```

如何实际填充历史记录将留给本指南的[导入/导出页面](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/)。

现在，让我们看看 iink SDK 如何[呈现](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/)某些内容。

# 渲染

本页介绍了 iink SDK 管理呈现的方式。您将学习如何使用 MyScript 提供的参考实现并正确将内容放在一起。

## [关键概念](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/#key-concepts)

有了这些概念，您将能够更好地了解如何使用[引用呈现实现](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/#reference-implementation)或构建您自己的（尚未记录）。

### [渲染目标](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/#render-target)

**渲染目标**（实现接口）表示将发生绘图操作的平台"视图"。`IRenderTarget`

### [帆布](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/#canvas)

**画布**对象提供 iink SDK 调用的图形命令的平台实现以呈现内容（在界面中定义）。`ICanvas`

### [渲染](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/#renderer)

**渲染器**是负责决定如何呈现每一图层内容的组件，它知道需要刷新模型的哪个区域，以及[缩放系数或视图偏移](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/zooming-and-scrolling/)等参数。它将通过执行实际绘图操作的画布对象发出呈现命令。

### [层](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/#layer)

出于性能原因，渲染器在不同的**图层**上工作。



[参考呈现实现](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/#reference-implementation)为您实现这些图层。但是，有时您可能需要与他们交互。

支持的图层包括：

- **背景**图层，对应于文本文档的参考线。
- **模型**图层，对应于引擎已处理的模型中的所有内容（描边、图像、类型集文本）、
- 临时**图层，**对应于临时元素（例如拖放操作中选择的项目），
- **捕获**图层，呈现在屏幕上绘制但尚未由引擎处理的墨迹。

每个图层都可以独立于其他图层刷新，因此不需要重新绘制所有内容，例如在现有内容上移动所选内容时。

## [参考实现](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/#reference-implementation)

为了便于构建应用程序，MyScript 在其[示例存储库](https://github.com/MyScript/interactive-ink-examples-android)中提供了默认呈现实现。

它作为一个库发布，在允许的许可证下，可以重复使用作为，或修改，如果你觉得需要。作为集成商，你只需要链接到它，并做一些管道：

## [返回示例](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/#back-to-the-example)

对于计算器的呈现部分，您可以仅重用 MyScript iink 代码示例一起引用实现。

一旦[参考实现](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/#reference-implementation)与项目集成，您所要做的就是相应的管道：

```java
import com.myscript.iink.Editor;
import com.myscript.iink.Engine;
import com.myscript.iink.Renderer;

public class Calculator
{
  private Renderer renderer;
  private Editor editor;

  public Calculator()
  {
    // Previous initialization
    ...

    // Create the view
    EditorView editorView = new EditorView(context);
    editorView.setEngine(engine);
    // ... add it to the UI hierarchy ...
    ...
    // accessing renderer
    renderer = editorView.getRenderer();
    // accessing editor
    editor = editorView.getEditor();
  }
}
```

如果此时编译和运行应用程序，您会注意到视图当前不会显示任何内容，因为您尚未向模型添加任何内容。这是本指南[下一步](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/)的目标。

# 编辑

本页重点介绍对象的角色，即与内容交互的中心点。`Editor`

## [设置零件](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#setting-a-part)

内容[`部分`](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#structure-of-the-model)上的作品。要设置它们之间的链接，请调用编辑器的方法并将其传递给您打开或创建的部件：`Editor``setPart()`

```java
// Create a new package
ContentPackage contentPackage = engine.createPackage(packageNameFile);

// Create a new part
ContentPart contentPart = contentPackage.createPart("Text");

// Accessing editor
Editor editor = editorView.getEditor();

// Associate editor with the new part
editor.setPart(contentPart);
```



在设置部件之前，必须确保之前调用[字体指标提供程序](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/conversion/#computing-font-metrics)并将其附加到编辑器。如果使用引用实现，调用将自动为您执行此操作。`editor.setViewSize()``editorView.getEditor()`

## [输入捕获](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#input-capture)

### [笔、指和工具管理](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#pen-finger-and-tool-management)

遵循[交互式墨迹](https://developer.myscript.com/docs/concepts/interactive-ink/)交互模式，iink API 认为**笔事件专用于编写或编辑内容**（文本、数学或形状内容、编辑手势等）和**触摸事件以操作内容**（选择、拖放、滚动等）。



如果用户具有活动手写笔，强烈建议采用交互式墨迹原理，即使用笔书写，用手指操作内容。

由于您负责向编辑器传播事件 - 如果用户使用手指或电容手写笔书写，或者您的应用程序是围绕一组模式工具构建的-您可以选择 iink SDK 应视为笔或触摸事件的内容。

输入的类型由枚举定义。`PointerType`

也可以使用它来选择具有特定行为的工具（例如橡皮擦）。

### [指南](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#guides)

默认情况下，文本文档和文本部分**设置了**参考线。指南为最终用户提供了有用的提示，让他们知道在哪里写，以什么大小。它们还提高了识别精度，前提是手写使用它们作为[基线](https://en.wikipedia.org/wiki/Baseline_(typography))。

![img](https://developer.myscript.com/docs/images/text-with-guides.png)

您可以通过[引擎](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/#configuration)或[编辑器](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#editor-level-configuration)配置的键启用或禁用**文本部件**的参考线。参考线之间的垂直间距可以通过[文本样式选项](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#text)进行调整。`text.guides.enable`

![img](https://developer.myscript.com/docs/images/text-without-guides.png)



如果您知道输入与参考线不匹配，例如，与来自非结构化上下文（如纸张）的墨迹不匹配，则必须禁用它们以确保良好的识别。

### [增量输入](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#incremental-input)

Interactive Ink SDK typically processes user input in real time. You thus have to tell how pointers (pen, finger) are interacting with the capture surface (typically a screen or a graphical tablet).

这可以通过调用对象的以下方法来实现：`Editor`

- `pointerDown()`- 当指针首次接触表面时。
- `pointerMove()`- 当指针在与曲面保持接触时移动。
- `pointerUp()`- 当指针从表面抬起时。

这些方法中的每一个都需要您提供：

- `x`和 - 指针表面的坐标`y`
- `t`- 指针事件的时间戳
- `f`- 与事件相关的压力信息（在 0 和 1 之间规范化）
- `pointerType`- 指针类型（笔、手指或预定义工具（如橡皮擦）：参见枚举）`PointerType`
- `pointerId`- 此指针的标识符。

例子：

```java
editor.pointerDown(0.0f, 0.0f, new Date().getTime(), .7f, PointerType.PEN, 1);
editor.pointerMove(1.3f, 2.0f, new Date().getTime(), .6f, PointerType.PEN, 1);
editor.pointerUp(2.0f, 4.0f, new Date().getTime(), .5f, PointerType.PEN, 1);
```



您可以调用让编辑器删除并忽略正在进行的事件序列。`pointerCancel()`

言论：

- 时间戳通常是自 1970 年 1 月 1日以来ms 中的时间。您可以将其设置为 -1，以便 iink SDK 根据系统的当前时间为您生成一个。
- 交互式墨迹 SDK 不使用压力信息。它存储在模型中，可以在[导出](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/)时或实现您自己的墨迹书写时检索。如果您没有或不需要此信息，则可以将其设置为 0。
- 如果只有一个指针同时处于活动状态，则可以传递指针 ID -1。

在最简单的情况下，您可以编写类似：

```java
final long NO_TIMESTAMP = -1;
final float NO_PRESSURE = 0.0f;
final int NO_POINTER_ID = -1;

editor.pointerDown(0.0f, 0.0f, NO_TIMESTAMP, NO_PRESSURE, PointerType.PEN, NO_POINTER_ID);
editor.pointerMove(1.3f, 2.0f, NO_TIMESTAMP, NO_PRESSURE, PointerType.PEN, NO_POINTER_ID);
editor.pointerUp(2.0f, 4.0f, NO_TIMESTAMP, NO_PRESSURE, PointerType.PEN, NO_POINTER_ID);
```

### [系列活动](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#series-of-events)

在某些情况下，您可能希望以单次传递将一组笔画发送到引擎，例如，如果从要作为单个批处理处理的 iink 模型外部导入墨迹。

对于所有类型的零件（但"文本文档"）iink SDK 提供了一种在单个传递一系列指针事件中输入的方法，该指针事件将参数为对象数组。`pointerEvents()``PointerEvent`

下面是一个示例：

```java
ArrayList<PointerEvent> events = new ArrayList<PointerEvent>();

// Stroke 1
events.add(new PointerEvent().down(184.f, 124.f));
events.add(new PointerEvent().move(184.f, 125.f));
events.add(new PointerEvent().move(184.f, 128.f));
events.add(new PointerEvent().move(184.f, 133.f));
events.add(new PointerEvent().move(184.f, 152.f));
events.add(new PointerEvent().move(184.f, 158.f));
events.add(new PointerEvent().move(184.f, 163.f));
events.add(new PointerEvent().move(183.f, 167.f));
events.add(new PointerEvent().move(183.f, 174.f));
events.add(new PointerEvent().move(183.f, 183.f));
events.add(new PointerEvent().up(183.f, 184.f));

// Stroke 2
events.add(new PointerEvent().down(150.f, 126.f));
events.add(new PointerEvent().move(151.f, 126.f));
events.add(new PointerEvent().move(152.f, 126.f));
events.add(new PointerEvent().move(158.f, 126.f));
events.add(new PointerEvent().move(166.f, 126.f));
events.add(new PointerEvent().move(184.f, 126.f));
events.add(new PointerEvent().move(190.f, 128.f));
events.add(new PointerEvent().move(196.f, 128.f));
events.add(new PointerEvent().move(200.f, 128.f));
events.add(new PointerEvent().move(207.f, 128.f));
events.add(new PointerEvent().move(208.f, 128.f));
events.add(new PointerEvent().up(209.f, 128.f));

// Feed the editor
editor.pointerEvents(events.toArray(new PointerEvent[0]), false);
```



When calling to process a large quantity of strokes, you should set the parameter to to explicitly prevent [gesture detection](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#edit-and-decoration-gestures) and allow better performances. `pointerEvents()``processGestures``false`

For the particular case of “Text Document” parts, you should:

1. Send each batch of pointer events to a dedicated “Text”, “Math”, “Diagram” or “Drawing” part depending on the type of the content you want to process. Remember to [disable the guides](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#guides) on “Text” parts if you cannot ensure that they will match the baselines of the ink words.
2. Call to ensure that the recognition is complete.`waitForIdle()`
3. Paste as a block into your “Text Document” part at the appropriate location.



When pasting a “Text” part into a “Text Document”, iink SDK will attempt to automatically adjust the handwritten content to the guides.

## [Edit and decoration gestures](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#edit-and-decoration-gestures)

Interactive Ink SDK supports all the standard gestures defined as part of [Interactive Ink](https://developer.myscript.com/docs/concepts/interactive-ink/).

There is nothing particular to do to benefit from gestures. The SDK will take care of detecting and applying the effect of the gestures from the provided input without any plumbing needed.

Decorations can be [styled](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/styling/) and will be taken into account when generating some of the [export formats](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/) (ex: text underlining will be ignored for a simple text export, will turn bold in the case of a export and be semantically tagged in a export).`docx``jiix`

## [Other edit operations](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#other-edit-operations)

The following operations can be directly made on the content of a part via an object:`Editor`

- **撤消/重做**：撤消/重做堆栈处理的 iink 操作是修改模型的操作。此类操作包括添加笔画、应用手势、转换内容。撤消/重做行为取决于内容类型：对于"文本"、"数学"、"文本文档"和"绘图"，它基于笔画。对于"图表"和"原始内容"，它基于会话。会话对应于 500 毫秒超时后一起识别的描边集。



有关进一步的详细信息，或者如果您需要将 iink SDK 撤消/重做与您自己的撤消/重做堆栈集成，请参阅[此页面](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/combined-undo-redo-stacks/)（高级）

- **清除**应用于整个"内容部分"。

但是，大多数操作都应在[内容块](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#content-blocks)上完成。

## [识别反馈](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#recognition-feedback)

UI 参考实现附带一个"智能指南"组件，允许您向最终用户提供实时文本识别反馈，并允许他们从引擎中选择替代解释。

有关详细信息，请参阅描述[如何使用文本识别候选项](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/text-recognition-candidates/)的页面。

## [监视模型中的更改](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#monitoring-changes-in-the-model)

在某些情况下，可以收到有关模型中发生的情况的通知。例如，您可能希望更新接口的撤消/重做按钮状态，或者仅在有东西要导出时才允许导出。

您可以调用并分别附加和删除您选择的对象，实现接口：该方法将告诉您何时在模型中发生任何更改。`addListener()``removeListener()``IEditorListener``contentChanged()`

`IEditorListener`还提供了一个[`onError（）`](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/error-management/#editor-level-errors)方法，您可以实现在出现问题时收到通知。**强烈建议实现它**，因为它允许检测一些经常看到的问题，如识别资产或引擎未找到的配置。

此外，该类还提供其他有用的方法/属性，例如：`Editor`

- `isIdle()`- 如果发动机正在进行的任何处理结束，则返回`true`
- `waitForIdle()`- 阻塞您的螺纹，直到发动机怠速。它允许在导出、转换或操作内容之前等待识别完成。



```
isIdle()`将始终在通知中返回。`false``contentChanged()
```



为了避免死锁，**请不要**从通知内部调用。`waitForIdle()``IEditorListener`

## [块管理](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#block-management)

### [内容块](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#content-blocks)

**内容块**是内容的语义细分，可能包含数据和/或其他块。它有一个唯一的 ID、一个定义的类型（"文本"、"数学"、"图表"、"绘图"、"原始内容"、"容器"...）和一个边界框。

例如：

- "Math"部分将仅包含一个块，承载数学内容本身。
- "文本文档"部分将更为复杂，因为它可以承载文本段落、数学方程、图表和绘图，这些段落排列在复杂的布局中，有时一个接一个，有时彼此并肩。在这里，"容器"块可用于将子块语义分组在一起。

下图显示了这些不同的块在其父部件内如何结合在一起：

包"文本"部分"数学"部分"文本文档"部分012获取根块"文本""数学""容器"块"数学""文本"获取部分"图表"块层次结构序列 化

当在配置中设置为时，"图表"块包含描述关系图内容的"文本"、"节点"、"边缘"或"Polyedge"类型的子块。`diagram.enable-sub-blocks``true`

### [导航块层次结构](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#navigating-the-block-hierarchy)

不同的块形成一个层次结构，可以通过在父部件上调用方法来获取根。反过来，每个块都有一个将返回其自己的子级（如果有）的方法。`getRootBlock()``getChildren()`

请务必注意，块层次结构**仅在给定的时间点有效**。例如，在文本文档中，插入新块、使用手势删除文本段落等是一些事件示例，这些事件可能会使以前检索的块层次结构无效。

可以通过调用块的方法来检查块是否仍然有效。或者，使用对象上查看[`内容更改（）`事件](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#monitoring-changes-in-the-model)将提供块可能已失效的提示（在参数中提供了受影响块的 ID 列表）。`isValid()``IEditorListener``Editor`

### [块添加](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#block-addition)

您创建的任何零件都将包含根块。

但是，您可以使用编辑器的方法在兼容部件的给定位置添加新块，作为[导入](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/)内容的一种方式（到目前为止，只有"文本文档"部件支持此功能）。`addBlock()`

专用方法允许您在文本文档部件中插入图像。`addImage()`

### [使用块的操作](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#operations-with-blocks)

与单个零件级别相比，块的粒度更细，可以执行某些操作：

- `hitBlock()`让您知道给定位置最顶层的块（如果有）。例如，它就可以知道用户点击或按下哪个块。
- `removeBlock()`允许您删除非根块。
- `convert()`允许您在给定块内[转换](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/conversion/)墨迹。
- `export_()`允许您[导出](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/)特定块的内容，包括其子块。
- `copy()`允许您将块复制到内部剪贴板中。然后，您可以使用 将其粘贴到给定位置，就像[添加新块一](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#block-addition)样。这仅适用于"文本文档"部分。`paste()`
- 您可以监视影响给定块的事件，因为接口的方法会为您提供有关受影响块的信息。`contentChanged()``IEditorListener`

## [编辑器级配置](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#editor-level-configuration)

虽然 iink SDK 可以在[引擎级别全局配置](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/#configuration)，但可以在编辑器级别覆盖此配置。这在类似窗体的用例中特别有用，因为需要使用不同的配置操作字段。

您可以通过调用并设置应以类似级联的方式**覆盖全局配置的键的值**来访问特定编辑器的配置。未在编辑器级别显式设置的键的值仍遵循引擎级配置。`getConfiguration()`

例如：

```java
Configuration globalConfig = engine.getConfiguration();
Configuration editorConfig = editor.getConfiguration();

// Global configuration values apply ...
String globalUnit = globalConfig.getString("math.solver.angle-unit"); // -> "deg"
String editorUnit = editorConfig.getString("math.solver.angle-unit"); // -> "deg"
globalConfig.setString("math.solver.angle-unit", "rad");
globalUnit = globalConfig.getString("math.solver.angle-unit");        // -> "rad"
editorUnit = editorConfig.getString("math.solver.angle-unit");        // -> "rad"

// ... except if overridden at editor level
editorConfig.setNumber("math.solver.fractional-part-digits", 4);
globalConfig.setNumber("math.solver.fractional-part-digits", 2);
Number editorDigits = editorConfig.getNumber("math.solver.fractional-part-digits"); // -> 4
Number globalDigits = globalConfig.getNumber("math.solver.fractional-part-digits"); // -> 2
```



与语言相关的设置以特定方式执行，因为它们仅被视为第一次将给定部件设置为编辑器，之后无法更改。`text.configuration.bundle``text.configuration.name`

## [返回示例](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#back-to-the-example)

[您以前](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/)创建了一个对象。由于您依赖于 MyScript 提供的[引用呈现实现](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/#reference-implementation)，墨迹输入将由 透明地管理。所有您需要做的是在[之前](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#back-to-the-example)编写的方法的末尾将部件加载到编辑器中：`Editor``EditorView``openContent()`

```java
public void openContent()
{
  // Load the part in the editor
  editor.setPart(contentPart);
}
```

如果您启动该应用程序，现在可以写入它，看到实际墨迹正在呈现！

接下来，您将插入撤消、重做和清除按钮。

通过调用适当的方法来响应用户操作，可以很方便地完成此操作：`Editor`

```java
public void undo()
{
  editor.undo();
}

public void redo()
{
  editor.undo();
}

public void clear()
{
  editor.clear();
}
```

由于"Math"部分由单个根块组成，因此您可以非常轻松地转换它。这将是本指南[下一步](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/conversion/)的主题！

# 转换

在 iink SDK 术语中，"转换"是指将一些手写内容更换为干净、类型集等效的内容。

## [转换与识别](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/conversion/#conversion-vs-recognition)

**转换**是您可以触发的显式操作，用于将墨迹内容替换为等效的类型集内容。它与它所依赖的**识别**过程不同，它运行在后台并解释任何输入，使其[具有交互性](https://developer.myscript.com/docs/concepts/interactive-ink/)。

您可以通过调用[编辑器对象](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/)的方法来转换任何[内容块](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#block-management)。`convert()`

## [目标状态](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/conversion/#target-state)

调用 时，应提供要达到的目标状态：`convert()`

- **数字发布**- 类型集内容，适用于发布（在文本文档的情况下，字体大小较小，并安装图形），
- **数字编辑**- 类型集内容，适合版本（字体大小足够大，可用于编辑、展开图形）。



您可以在数字发布和数字编辑状态之间来回转换。

## [计算字体指标](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/conversion/#computing-font-metrics)

要转换文本内容，iink SDK 需要包含有关您使用的字体的信息，这本身取决于您的[样式选项](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/styling/)。为此，它要求您使用 将实现接口的对象附加到编辑器中。`IFontMetricsProvider``setFontMetricsProvider()`

由于实现字体指标提供程序是一个相当敏感的任务，MyScript 通过 iink SDK 示例存储库为您提供[参考实现](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/#reference-implementation)。



如果依赖于[引用实现](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/#reference-implementation)，则将编辑器注册到编辑器视图会自动将字体指标提供程序附加到编辑器。

## [应用于示例](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/conversion/#application-to-the-example)

您可以将按钮添加到示例计算器以触发转换。如前所述，将编辑器视图与编辑器关联会自动附加字体指标提供程序。

由于数学部分由单个[块](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#block-management)（承载数学内容）组成，因此可以使用编辑器的方法选择它。如果按下 UI 的"解算"按钮调用对象的方法，则实现可以是：`getRootBlock()``solve()``Calculator`

```java
editor.convert(editor.getRootBlock(), ConversionState.DIGITAL_EDIT);
```



由于您正在处理数学内容，并且未停用解算器，因此转换数学将触发求解（如果所需的条件已到位）。

下面是一个示例，了解它的外观：

![img](https://developer.myscript.com/docs/images/calculator-example-converted-solved.png)

本指南的下一步将引导您完成[导入或导出内容](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/)的能力。

## [有用的链接](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/conversion/#useful-links)

- [内容块](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#block-management)

# 进出口

此页面将您通过将内容导入 iink SDK 或将其导出以用于外部用途的可用可能性。



交互式墨迹 SDK 区分[序列化/反序列化](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/)（以快速且空间高效的方式存储模型的全部内容，以供 SDK 将来重用）和导入/导出（作为与其他应用程序交换 iink 内容的一种方式）。

## [导入内容](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/#importing-content)

### [导入到块中](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/#import-into-a-block)



本部分描述*除从 JIIX 导入的文本数据的所有情况*的导入行为，[此处](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/#text-jiix-import)介绍。

您可以将数据导入[到内容块](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#block-management)中。例如，以下代码将"Hello iink SDK"文本字符串导入到"文本"部分：

```java
ContentPart textPart = ... // Get the part
editor.setPart(textPart);
editor.import_(MimeType.TEXT, "Hello iink SDK", editor.getRootBlock());
```

在这种情况下，您可能省略了指定块。由于部件仅承载单个根块，因此 iink SDK 可以自行计算导入内容的位置：

```java
editor.import_(MimeType.TEXT, "Hello iink SDK", null);
```

对于可以承载多个块（如"文本文档"部件）的部件，需要显式指定目标块。如果尚不存在，可以调用[`addBlock（）`](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#block-addition)并直接传递数据以导入。

可以通过调用编辑器获取给定块受支持的 mime 类型列表。例如：`getSupportedImportMimeTypes()`

```java
MimeType[] supportedMimeTypes = editor.getSupportedImportMimeTypes(editor.getRootBlock());
```



导入内容是"破坏性的"：预先存在的内容将被清除和替换（[从 JIIX 导入的文本数据](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/#text-jiix-import)除外）。

### [文本 JIIX 导入](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/#text-jiix-import)

当涉及到文本数据时，JIIX 导入到目前为止仅限于[文本单词候选更改](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/text-recognition-candidates/)。稍后将提供更多导入功能。

要更改给定文本或关系图块中的文本候选项，：

1. 将块导出为 JIIX 格式。
2. 将目标替换为**`候选`列表中**的另一个单词。`label``word`
3. Import the modified JIIX data back to your block.



Importing JIIX data is only possible if the target block was not modified since it was exported. For more information, refer to [this page](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/text-recognition-candidates/#programmatically-manage-candidates).

### [Raw ink import](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/#raw-ink-import)

To import raw ink content, instantiate an editor and pass it an array of pointer events. Note that in this scenario, except if you are working on a “Drawing” part, the recognition engine will automatically process the new strokes. This approach is documented in the [Editing](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#series-of-events) part of this guide.

## [Exporting content](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/#exporting-content)

### [Make sure that recognition is complete](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/#make-sure-that-recognition-is-complete)

Recognition can sometimes take a certain time to complete, especially if you send many strokes to the editor at once.

If you want to make sure that you export the final recognition results, you have to call **before** .`waitForIdle()``export_()`

### [选择要导出的内容](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/#select-what-you-want-to-export)

导出操作是在[内容块](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#block-management)上进行的。例如，这允许您从文本文档部件导出特定关系图。

可以通过调用编辑器来检索给定块受支持的导出 mime 类型的列表：`getSupportedExportMimeTypes()`

```java
MimeType[] supportedMimeTypes = editor.getSupportedImportMimeTypes(block);
```

要导出内容，请调用编辑器对象的方法，将其传递给导出的块和所需的 mime 类型：`export_()`

```java
// Export a math block to MathML
String result = editor.export_(mathBlock, MimeType.MATHML);
// Export a text document to docx
editor.export_(textDocBlock, new File("export.docx"), MimeType.DOCX, imageDrawer);
```

API 提供了一种方便的方法，如果 iink SDK 能够从文件扩展名中明确猜测它，则可以省略 mime 类型：

```java
// Export a text document to docx
editor.export_(block, new File("export.docx"), imageDrawer);
```



可以调用 获取给定 mime 类型的扩展。`getFileExtensions()`

### [图像抽屉](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/#image-drawer)

某些格式要求您提供实现接口的对象，以便 iink SDK 从内容生成图像。预期情况和导出的情况，但也适用于格式，如 。`IImageDrawer``png``jpeg``docx`

MyScript 作为[UI 参考实现的](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/#reference-implementation)一部分，提供了默认的、即用的映像抽屉实现。

如果格式不需要图像抽屉，则可以向导出方法提供空指针。



要知道哪些格式需要图像抽屉，请参阅[此页面](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/)。

### [文本与二进制导出](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/#textual-vs-binary-exports)

文本格式导出将作为字符串返回，然后可以通过编程方式操作。另一方面，二进制格式将保存为磁盘上的文件，位置可以指定。

```java
IImageDrawer imageDrawer = new ImageDrawer();
editor.export_(editor.getRootBlock(), new File("out/export.docx"), imageDrawer);
```

可以调用对象的方法，了解格式是文本格式还是二进制格式。`isTextual()``MimeType`

### [应用特定配置](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/#apply-a-specific-configuration)

某些导出功能允许您临时"覆盖"当前编辑器配置，以需要特定的导出。如果要调整导出参数（如要导出到 JIIX 的信息类型），而不影响全局或编辑器配置，则此功能非常有用。

下面的示例演示如何将块识别结果导出为 JIIX，而不包括原始墨迹信息：

```java
// Create an empty parameter set
ParameterSet params = engine.CreateParameterSet();
// Set the appropriate configuration to exclude strokes from the export
params.setBoolean("export.jiix.strokes", false);
// Export a block with the new configuration
String jiix = editor.export_(block, MimeType.JIIX, params);
```

## [支持的进口/出口](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/#supported-importsexports)

### [交换格式](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/#exchange-format)

交互式墨迹 SDK 定义自己的格式，称为**JIIX（JSON**交互式墨迹 eXchange 格式的缩写）。

此格式提供支持的不同类型的内容的**一致**表示形式，涵盖**语义**、**位置**、**样式**和**与墨迹相关的**方面。

由于其JSON语法，它保持**可读性**，并可以很容易地**解析**，使其适合与主机应用程序交换信息或作为一个暂时的表示形式来支持自定义导出格式。



完整的 JIIX 引用[可以在这里](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/)找到。

### [其他格式](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/#other-formats)

交互式墨迹 SDK 允许您导入和导出一些常用格式，例如数学内容的 LaTeX 或文本文档块中的 Docx。

完整列表可以[在这里](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/)找到。

## [返回示例](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/#back-to-the-example)

对于计算器示例，您已经编写了一些代码，这些代码允许您将历史记录保存到零件元数据，并在以后检索它。现在，让我们看看如何使用导出功能填充历史记录字符串列表。

在这里，您将希望在每次计算导致新状态后将新项目追加到历史记录中（多次按"+"将只注册单个状态）。因此，您可以改进方法：`solve()`

```java
public void solve(TreeSet<String> history)
{
  // ... Do the conversion ...

  // Add the item to the history if there was a change
  String latexStr = editor.export_(editor.getRootBlock(), MimeType.LATEX);
  if (latexStr != null && !latexStr.equals("") && (history.isEmpty()  || history.last() != latexStr))
    history.add(latexStr);
}
```



在考虑零件的全部内容时，可以传递到导出方法的第一个参数的空指针，而不是根块。

就是这样！您现在有一个永久计算历史记录，您可以随时引用它！

指南的下一部分将讨论[缩放和滚动](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/zooming-and-scrolling/)。

## [有用的链接](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/#useful-links)

- [使用内容块](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#block-management)
- [支持导入/导出格式](https://developer.myscript.com/docs/interactive-ink/1.3/overview/import-and-export-formats/)
- [JIIX 格式参考](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/)

# 缩放和滚动

本页说明如何通过 iink SDK 对象管理缩放和滚动。`Renderer`

## [查看转换矩阵](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/zooming-and-scrolling/#view-transformation-matrix)

虽然交互式墨水本质上是数字的，但手写本身却植根于物理世界。使用特定行间距书写时，用户感觉很舒服，并且会根据手写笔的类型和质量以不同的方式书写。同样，如果墨环与圆几乎无法区分，或者其宽度为一厘米，识别引擎也不会以同样的方式解释墨迹圈。与物理世界中的这种锚定一如是，iink SDK 在内部以毫米为单位存储其数据。

但是，您的应用程序很可能在视图坐标中工作，而这是您将依赖的将输入调度到 SDK 的单位。您可能还指定了缩放系数，因此情况可能会变得复杂。

交互式墨迹 SDK 通过附加到编辑器的[`呈现器`对象的](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/#renderer)**视图转换**来链接这两个坐标系。它考虑了 dpi、缩放和潜在偏移。

与大多数 iink SDK API 一样，您不需要自己操作转换矩阵。但是，您可以通过调用渲染器来访问它，并用它来从一个系统转换为另一个系统。`getViewTransform()`

## [查看大小](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/zooming-and-scrolling/#view-size)

视图的大小必须提供给使用 的编辑器。如果没有，则在尝试将部件附加到编辑器时将引发异常（请注意，在[引用实现](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/#reference-implementation)中，此调用是作为对象实现的一部分为您进行的）。`setViewSize()``EditorView`

视图的大小在使交互式内容动态重排和调整视图大小方面起着重要作用。

## [缩放和滚动管理](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/zooming-and-scrolling/#zoom-and-scroll-management)

缩放和滚动通过作用于视图转换矩阵进行管理。但是，呈现器对象上提供了一组方便方法，而不是直接操作它。



如果更改渲染器变换矩阵，则需要使渲染目标无效以强制重绘。

### [缩放](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/zooming-and-scrolling/#zooming)

您可以通过调用 和 操作视图比例的绝对值。2.0 的比例将使内容看起来比实际内容大一倍，而 0.5 的比例将使内容变小两倍。`getViewScale()``setViewScale()`

或者，您可以通过调用并传递所需的因子来**相对于当前比例**应用缩放系数。`zoom()`

例如：

```java
renderer.setViewScale(2.0f); // Scale = 2.0f
renderer.zoom(4.0f);         // Scale = 8.0f
```

如果要处理捏合以缩放手势，可能还需要指定要调整缩放的点的位置。在这种情况下，除了要应用的缩放系数外，还要使用并提供要考虑的点的坐标。`zoomAt()`

### [滚动](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/zooming-and-scrolling/#scrolling)

要滚动视图，只需使用要考虑的偏移和绝对分量调用渲染器。`setViewOffset()``x``y`

例如：

```java
renderer.setViewOffset(2.0f, 3.0f);
renderer.setViewOffset(1.3f, 2.0f);
```

您可以使用 获取当前视图偏移量。`getViewOffset()`

### [监视转换矩阵更改](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/zooming-and-scrolling/#monitoring-transformation-matrix-changes)

您可能希望将侦听器附加到呈现器，以便通知转换矩阵更改（例如，以调整用户界面）。此类侦听器应实现接口的方法，并且可以使用 和 方法分别附加到或脱离渲染。`viewTransformChanged()``IRendererListener``addListener()``removeListener()`

## [返回示例](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/zooming-and-scrolling/#back-to-the-example)

假设您要为手写计算器实现水平缩放滑块，该滑块在对象上调用方法，浮动值介于 0.25（最左侧时）到 4.0（最右侧时）和中等值 1.3（当它位于中心时）。`setZoomScale()``Calculator`

然后，您可以实现方法，如下所示：

```java
public void zoom(float scale)
{
  renderer.setViewScale(scale);
  renderer.getRenderTarget().invalidate(renderer, EnumSet.allOf(IRenderTarget.LayerType.class));
}
```

现在，如果您启动应用程序并将滑块向右移动，则在向左移动滑块时，将放大并缩小。

分步指南的下一部分将展示如何[设置内容的样式](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/styling/)。

# 造型

交互式墨迹 SDK 使内容易于设置样式。在本指南的这一部分中，您将学习如何设置主题以及如何随时更改笔的颜色。

## [设置主题](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/styling/#setting-a-theme)

**主题**是影响特定对象呈现内容的外观的样式表。它不是特定于任何特定的内容，因此**它不存储在**中。`Editor``ContentPart`



如果由配置不同主题的两个编辑器实例打开，则相同的内容看起来会有所不同。

样式表应作为字符串传递给对象的方法。例如，要将当前编辑器的默认墨迹颜色设置为蓝色，可以编写：`setTheme()``Editor`

```java
editor.setTheme("stroke { color: #0000FFFF; }");
```

交互式墨迹 SDK 附带一个内置的默认主题。由提供的样式表定义的值具有更高的优先级并覆盖默认样式。

主题更改不由 iink SDK 撤消/重做堆栈管理。要让用户撤消或重做主题更改，您必须在集成端对其进行管理。对于可能的实现路径，请阅读如何将 iink SDK 撤消/重做堆栈与应用程序（高级）的堆栈组合在一起。

有关可用样式选项的详细信息，请参阅完整[样式参考](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/)。

## [更改笔的样式](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/styling/#changing-the-style-of-the-pen)

可以设置与笔关联的样式，例如更改其颜色或厚度。当向最终用户提供调色板或让他/她定义笔工具的特征时，这非常有用。

有两种可能的方法：通过主题或设置动态样式。

### [通过主题](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/styling/#via-the-theme)

**主题方法**包括指定与自定义主题中不同的笔配置对应的类，以及通过调用编辑器将给定样式应用于笔工具。`setPenStyleClasses()`

第一种方法是最有效的方法，当为用户提供一组固定的选择时，这种方法更适合。但是，它将依赖于主题，因此不会存储在内容部分中。

例子：

```java
editor.setTheme(".greenThickPen { color: #00FF00FF; -myscript-pen-width: 1.5; }");
editor.setPenStyleClasses("greenThickPen");
```

### [通过动态样式](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/styling/#via-dynamic-styles)

此方法包括通过调用编辑器直接设置笔工具的样式。`setPenStyle()`

在处理时间方面不如正发方法**最优**。但是，它可以轻松地动态创建样式（例如，如果您允许用户构建自己的调色板），并将保存在内容部分中。

例子：

```java
editor.setPenStyle("color: #00FF00FF; -myscript-pen-width: 1.5");
```



虽然可以通过随时设置主题来更新内容的整体外观和感觉，但 iink SDK 目前无法提供专门修改*后元素*样式的可能性。预计将在将来的版本中登陆。

## [iink SDK CSS 特异性](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/styling/#iink-sdk-css-specificities)

**级联样式表**（CSS） 是声明样式内容（例如 Web 上的）的一种非常常见的方法。交互式墨迹 SDK 仅依赖于 CSS 的子集进行样式设置，并记住了一些要记住的特性。

### [限制](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/styling/#restrictions)

以下限制适用：

- 仅支持有限的 CSS 属性子集。
- 支持的类型不同于常规 CSS 的类型（例如，类型选择器（如 ，或不支持）。`h1``p``div`
- 默认单位是，并且将忽略显式单位提供的属性。`mm`
- 关键字（如 ）或不支持。`inherit``initial``unset`
- 不支持通用选择器 （），组合器也不是。`*`

### [CSS 类型](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/styling/#css-types)

交互式墨迹 SDK 公开以下类型层次结构：

- ```
  ink
  ```

  \- 对下面描述的所有类型进行分组：

  - `stroke`- 仅限手写笔画
  - `glyph`- 转换的文本字形
  - `line`- 转换的行，例如转换关系图时获取的
  - `arc`- 转换的椭圆弧、椭圆和圆
  - `guide`- 文本指南

### [内置类和属性](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/styling/#built-in-classes-and-properties)

支持类和属性的完整引用[可以在这里](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/)找到。

## [返回示例](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/styling/#back-to-the-example)

### [自定义主题](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/styling/#custom-theme)

让我们首先调整计算器的主题。存储在数学部分中的语义样式元素有几种可能性。

![img](https://developer.myscript.com/docs/images/style-before.png)

例如，您可能希望转换的内容看起来更蓝，同时保留手写墨迹的默认黑色。您还可以为数学解算器的结果选择漂亮的绿色，并将字体设置为粗体（权重为 700）和斜体。

代码如下所示：

```java
editor.setTheme("glyph.math { color: #3A308CFF; }" +
                "glyph.math-solved {" +
                "  color: #1E9035FF;" +
                "  font-weight: 700;" +
                "  font-style: italic;" +
                "}");
```

![img](https://developer.myscript.com/docs/images/style-after.png)

在此示例中，新样式表中定义的值覆盖了默认内置样式表的值。

### [笔颜色选项](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/styling/#pen-color-options)

现在，假设您要为用户提供调色板，让他们使用两种不同的墨迹颜色，其中一种是您定义的默认蓝色，另一种是红色（教师可用于更正练习的颜色）。

有两种方法可以继续：使用或在主题级别使用"动态"创建笔样式，并指定一组对应于预定义颜色的类，并使用 应用这些样式。`setPenStyle()``setPenStyleClasses()`

在处理预定义的颜色时，第二种方法可能是最好的，而且它恰好也是最有效的方法。

您可以首先向自定义主题添加两个新类（每支笔一个）：

```java
editor.setTheme(".math { color: #3A308CFF; }" +
                "glyph.math-solved {" +
                "  color: #1E9035FF;" +
                "  font-weight: 700;" +
                "  font-style: italic;" +
                "}" +
                ".defaultPen { color: #3A308CFF; }" +
                ".correctionPen { color: #FF0000FF; }");
```

现在，对选择其中一个笔选项的反应只是调用任一事项：

```java
editor.setPenStyleClasses("defaultPen");
```

或

```java
editor.setPenStyleClasses("correctionPen");
```

分步指南的最后一部分将讨论[错误管理](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/error-management/)，并提供有用的提示，说明在遇到一些令人费解的行为时可能发生的情况。

## [有用的链接](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/styling/#useful-links)

- [样式参考](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/)

# 错误管理

本页介绍如何使用 iink SDK 管理错误，以及常见的陷阱

## [获取错误通知](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/error-management/#getting-error-notifications)

有两种方法可以返回错误 iink SDK：

1. 在调用 API 期间通过异常。
2. 在后台线程中发生错误时通过。`IEditorListener.onError()`

### [异常](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/error-management/#exceptions)

每个 API 调用的可能异常在相应的 API 标头中进行了详细介绍。

### [编辑器级错误](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/error-management/#editor-level-errors)

强烈建议您实现作为集成的一部分。此回调提供详细消息来解释发生的情况。`IEditorListener::OnError()`

下表列出了主要错误及其可能的原因：

| 错误                                                         | 消息                                                         | 可能的原因/解决方案                                          |
| :----------------------------------------------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| [配置](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/)错误 | "错误：没有此类配置"                                         | 找不到配置文件。检查包含该文件的文件夹是否由[引擎](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/#configuration)或[编辑器配置](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#editor-level-configuration)的键引用。`*.conf``configuration-manager.search-path` |
|                                                              | "错误：没有此类配置捆绑包"                                   | 找不到配置捆绑包。检查[引擎](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/#configuration)或[编辑器配置](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#editor-level-configuration)指定的文件中是否存在具有提供名称的捆绑包。`*.conf` |
|                                                              | "错误 ：无效配置类型""错误：无法扩展占位符中的环境变量 $*"，" 错误：无效命令"... | 分析文件时出错。此消息的许多变体都存在，每个变体都应不言自明。`*.conf` |
| 墨迹无法添加到文本文档                                       | 墨迹被拒绝：笔画太小（写得更大）                             | 发送到零件的笔画太小。它可能源于使用错误的 dpi 值来配置呈现器。 |
|                                                              | 墨迹被拒绝：笔画太大（写得更小）                             | 您发送的笔画垂直太大：文本文档部分假定墨迹写入参考线而不是跨参考线。 |
|                                                              | "墨迹被拒绝：笔画高于第一行"                                 | 墨水写在顶部边距内。                                         |
|                                                              | 墨迹被拒绝：无法写入数字发布段落（转换为数字编辑）"          | 处于转换状态的文本块只能接收编辑/修饰手势，但无法输入。您必须将它们转换为添加额外内容。`DIGITAL_PUBLISH``DIGITAL_EDIT` |
|                                                              | "墨迹被拒绝：笔画超出文档边界"                               | 墨迹是在页面边界之外书写的。请注意，每次添加内容时，iink SDK 都会在页面末尾分配与提供的视图大小高度对应的额外垂直空间。 |
|                                                              | "墨迹被拒绝：笔画太长"                                       | 冲程的长度（即其点数）超过发动机可以处理的长度。             |
| 处理的笔画太多                                               | "LIMIT_EXCEEDED"                                             | 您向识别引擎发送的笔画比它可同时处理的内容多。               |
| 意外错误                                                     | "INVALID_STATE"或"INTERNAL_ERROR"                            | 识别引擎遇到意外错误。                                       |

### [发动机级错误](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/error-management/#engine-level-error)

| 错误       | 消息             | 可能的原因/解决方案                                          |
| :--------- | :--------------- | :----------------------------------------------------------- |
| 无法打开包 | "错误：包已打开" | 在关闭内容包之前，应确保[编辑器处于空闲状态](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#monitoring-changes-in-the-model)，并且[引用此内容包的对象不会保留](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/#objects-lifecycle)。 |

### [证书错误](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/error-management/#certificate-errors)

它通常采用打印到控制台的消息的形式。`INVALID_CERTIFICATE`

如果发生这种情况，请检查：

1. 证书没有时间限制或仍然有效
2. 如果从开发人员门户检索证书，请检查该证书是否为应用程序的捆绑 ID 生成。

### [无识别](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/error-management/#no-recognition)

如果识别不起作用，您通常可以通过查看[编辑器提出的](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/error-management/#editor-level-errors)错误来得到根本原因：

最有可能涉及以下原因：

- **未找到配置**- 确保您引用的文件是提供给引擎/编辑器的路径的一部分，并且捆绑包的名称正确。`*.conf`
- **找不到识别资产**- 确保识别资产与应用程序一起正确部署，并由文件正确引用。`*.conf`

### [识别质量差](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/error-management/#recognition-quality-is-poor)

下面是在这种情况下要考虑的一个小清单：

1. **您是否指定了正确的语言？**- 检查[引擎](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/#configuration)或[编辑器](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#editor-level-configuration)配置以及相应的文件和所选捆绑包。`*.conf`
2. **如果要识别文本，是否启用[了参考线](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#guides)？**- 如果他们是，但你不依赖他们，他们可能会负面影响的承认。
3. **在尝试检索结果之前，您是否呼叫`了 waitForIdle（）？`** - 临时结果可能不如最后的结果相关。
4. 实例化**渲染器时是否提供了适当的 dpi 值？**- 这是为发动机提供"缩放"感的基础，例如，如果缺少上下文，它可以让它区分一个圆圈、字母"o"或点。
5. **您是否发送了正确的内容？**- 如果没有，您不太可能获得预期的输出😉！

# 文本识别候选人

## [单词识别候选人](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/text-recognition-candidates/#word-recognition-candidates)

MyScript 手写识别尝试正确猜测用户正在写入的内容，但输入有时可能不明确，如以下示例所示：



它应该被解释为"你好"还是"贝拉"？作为一个人，你可能会回答"你好"。这也是 MyScript 引擎在这种情况下的想法。然而，也有一种可能性，作者实际上意味着"贝拉"，"海拉"，甚至"贝洛"...

在内部，识别引擎考虑不同的假设，并试图拿出最好的一个作为**选定的单词候选**。它还将返回其他顶级假设，如"贝拉"或"bello"作为替代**词识别候选人**。

考生可以帮助您的用户轻松更正潜在的识别错误，或帮助实现一个搜索引擎，该搜索引擎可以在具有一定容差的手写笔记上运行。

您可以通过编辑[识别配置文件](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/)并分配给所需值来调整识别引擎应返回的最大单词候选数。`SetWordListSize`

## [以编程方式管理候选人](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/text-recognition-candidates/#programmatically-manage-candidates)

您还可以与来自您自己的代码的候选项进行交互（这实际上是实现提示符的方式）。

假设您得到了以下墨迹：



如果您要求 MyScript 进行文本导出，它只需返回"候选测试"，这对应于根据引擎的最佳解释。要访问识别候选项，您需要请求 JIIX 导出。

结果如下所示（为了示例，仅保留 JIIX 导出的相关部分，删除所有墨迹和边界框信息）：

```javascript
{
 "type": "Text",
 ...
 "label": "Candidate test",
 "words": [ {
   "label": "Candidate",
   "candidates": [ "Candidate", "candidate", "Candidates", "candidates" ],
   ...
  }, {
   "label": " "
  }, {
   "label": "test",
   "candidates": [ "test", "Test", "best", "tests", "Lest" ],
   ...
  } ]
}
```

"候选人文本"解释由顶级"标签"键提供。

此顶级识别结果分为一组"单词"，每个"单词"都有自己的标签和一组候选项（字内空格除外）。

每个单词的"候选"键允许访问从最大到不太可能排序的候选数组。默认情况下，作为"标签"存储的选定候选项是列表的第一个元素。

要选择其他候选人，您需要：

1. 将标签的值更新到其中一个建议的候选人。
2. 将 JIIX 内容重新导入原始块。

从那里，iink SDK 将保留您的选择，除非内容的变化导致它完全重新考虑对本部分的识别。

**重要：**

- 始终使用与**现有**候选项对应的值更新标签。这是因为否则 iink SDK 可能无法计算如何将此解释映射到原始墨迹。
- 要重新导入内容**，请确保除了更改"标签"值之外，您没有更改任何内容，无论是在原始块中还是在 JIIX 内容中**。

# 屏幕外使用

本页说明如何在没有图形界面的情况下使用交互式墨迹 SDK。

## [用例](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/off-screen-usage/#use-case)

交互式墨迹 SDK 主要设计为面向图形的交互式解决方案，使最终用户能够轻松输入和编辑手写内容。

但是，有时在没有任何用户界面的情况下将 iink SDK 集成在[屏幕外](https://developer.myscript.com/docs/concepts/off-screen/#off-screen)是有意义的。可能需要在[批处理模式下](https://developer.myscript.com/docs/concepts/batch-mode/#batch-mode)将手写识别功能添加到现有非交互式应用程序。在不显示识别结果的情况下以[增量](https://developer.myscript.com/docs/concepts/batch-mode/#incremental-mode)模式处理输入可能也很有用，例如实现墨迹搜索索引服务。

事件 （x，y） 以像素为单位墨迹捕获输入输出导出的文档（x，y） 以毫米为单位渲染捕获设备分辨率（德皮克斯，德皮）

## [设置](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/off-screen-usage/#setup)

屏幕外设置与图形用例非常相似：

1. [创建和配置引擎](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/)。
2. 从引擎创建渲染器，并将其传递**为空渲染目标**。
3. 创建要处理的相应类型的[包](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#creating-or-loading-content)和[内容部分](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/storage/#structure-of-the-model)。
4. 创建编辑器、**设置其视图大小**并**附加字体指标提供程序**（对于大多数平台，可以重用[UI 参考实现](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/#reference-implementation)中随附的编辑器）。
5. [将零件附加到](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#setting-a-part)编辑器。

## [常见陷阱](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/off-screen-usage/#common-pitfalls)

- **dpi 值**- 虽然不显示笔画，但您需要向渲染器提供适当的 dpi 值。这些对应于输入面的"分辨率"，无论是数字屏幕还是纸张。它们将为识别者提供"写作尺度"的感觉，并帮助它有利于正确的假设。
- **文本指南**- 如编辑部分所述，[文本参考线](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#guides)可提高识别精度，前提是手写使用它们作为[基线](https://en.wikipedia.org/wiki/Baseline_(typography))。但是，如果手写与参考线不匹配，则识别质量可能会产生负面影响。**因此，在大多数屏幕外方案中，建议将其关闭**。
- **编辑器视图大小**- 编辑器要求您在设置零件*之前*提供大小。此大小应与书写表面和提供给渲染器的 dpi 值一致。它将被一些导出选项使用。
- **字体指标提供程序**- 虽然您可能不想显式[转换](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/conversion/)，但您需要在设置部件*之前*将字体指标提供程序附加到编辑器。这是因为字体指标不仅可用于显示，还可用于内容布局管理或某些导出选项。
- **在会话之间清除编辑器**- 批处理模式下的一个常见错误是忘记在导入之间清洁零件，从而导致新墨迹堆叠在上一个会话的墨迹之上。因此，在大多数情况下，在处理新输入之前必须清除零件。为每个新会话创建新部件并删除前一个会话将释放内存，从可能不需要的撤消/重做历史记录中释放内存。
- **手势处理**- 对于[在批处理模式下](https://developer.myscript.com/docs/concepts/batch-mode/#batch-mode)调用编辑器时的非交互式应用程序，请确保将参数设置为，以避免副作用和较长的识别时间。`pointerEvents()``processGesture``false`
- **识别完成后导出**- 请确保调用编辑器等待识别完成，然后再导出。`waitForIdle()`

## [例子](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/off-screen-usage/#example)

```java
// Configure the engine to disable guides (recommended)
engine.getConfiguration().setBoolean("text.guides.enable", false);

// Create a renderer with a null render target
float dpiX = ...;
float dpiY = ...;
Renderer renderer = engine.createRenderer(dpiX, dpiY, null);

// Create the editor
Editor editor = engine.createEditor(renderer);

// The editor requires a font metrics provider and a view size *before* calling setPart()
DisplayMetrics displayMetrics = getResources().getDisplayMetrics();
Map<String, Typeface> typefaceMap = new HashMap<>();
editor.setFontMetricsProvider(new FontMetricsProvider(displayMetrics, typefaceMap));
editor.setViewSize(640, 480);

// Create a temporary package and part for the editor to work with
ContentPackage package = null;
try
{
  package = engine.createPackage("text.iink");
}
catch (IOException e)
{
  e.printStackTrace();
}

ContentPart part = package.createPart("Text");
editor.setPart(part);
```

编辑器现在可用于[处理指针事件](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#input-capture)并[导出](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/import-and-export/#exporting-content)结果。

# 自定义墨迹书写

本页说明如何自定义 iink SDK 笔画呈现。

## [术语](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-inking/#terminology)

在 MyScript 术语中，"墨迹书写"是指呈现墨迹描边的过程。墨迹书写算法通常处理笔画**点坐标**、其相关**压力**或**时间戳**信息以及**描边样式**（如颜色或宽度）。它包括两个主要步骤：

1. 计算包络（即笔画的几何体），
2. 笔画本身的绘制。

虽然 iink SDK 附带其自己的内置墨迹，但该工具包足够灵活，可让您自定义这些步骤。

## [用例](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-inking/#use-cases)

如果要将 iink SDK 集成到已经实现其自己的墨迹功能的应用程序中，则可能需要确保相同的呈现算法同时用于 iink 和应用程序托管的内容。

交互式墨迹 SDK 可以调整，以解决以下用例：

- 您只想**影响描边的形状**以进行渲染，让 iink SDK 通过抚摸或填充您定义的信封来绘制笔画。在这种情况下，你所要做的就是[实现和注册自己的笔触器](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-inking/#custom-stroker)。
- 此外，您还希望**自己绘制描边**，例如，如果您需要绘制纹理描边，或者如果您依赖于 OpenGL 等渲染技术，并且希望使用粒子而不是填充信封。在这种情况下，除了[实现您自己的笔画器](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-inking/#custom-stroker)（iink SDK 需要它，如下节所述），还需要将信息存储在生成的路径中，以便能够使用它们[自行呈现笔画](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-inking/#custom-drawing-of-the-strokes)。

## [iink SDK 的要求](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-inking/#requirements-from-iink-sdk)

独立于要应用于笔画渲染的自定义量，iink SDK**需要尽可能精确地了解要绘制的笔画的包络**。

信封对应于笔画的几何形状，如下图所示：

中风信封

除其他事项外，了解笔画的包络可使 iink SDK 优化渲染操作（通过计算区域在模型更改后刷新），了解在给定时间点渲染哪些项并管理选择的几何体。精确的信封定义是获得良好结果的关键。

## [如何使用 API](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-inking/#how-to-use-the-api)

要定义自己的笔触笔，您应该：

1. 实现接口：其和方法分别允许您将给定笔画的包围作为实例返回，并选择 iink SDK 是填充还是只是描边生成的路径。`IStroker``stroke()``isFill()``IPath`
2. 实现接口：该方法将允许您返回自定义笔划器的实例。`IStrokerFactory``createStroker()`
3. 实例化自定义笔触器工厂并将其注册到接口方法（以后可以使用接口上的方法取消注册）。此方法还允许您指定与笔画器对应的*画笔*的名称。`IRenderer``registerStroker()``unregisterStroker()``IRenderer`
4. 使用定义的画笔名称来设置墨迹的[样式](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/styling/)。

要自行呈现笔画，您可能需要自己实现来存储通过接口方法提供的笔画信息。然后，存储在对象中的数据将以方法提供，以便您以自定义方式绘制笔画。`IPath``stroke()``IStroker``IPath``ICanvas``drawPath()`



通过[UI 参考实现](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/#reference-implementation)为每个目标平台提供了特定于平台的接口实现。您可以调整或对它进行子类，以存储笔画信息。`IPath`

请注意，根据路径是否关闭以及返回的值，您将定义不同的包络。下图以黑色显示生成的信封，具体取决于红色路径的选项和状态：`isFill()`

渲染（填充 = true）路径渲染（填充 = 假）w/2

如您所见，如果选择在 方法中返回，iink SDK 将考虑比路径严格返回的包络大，因为它将考虑描边笔画的像素宽度（方法的参数）来描边路径。`false``isFill()``width`

## [代码段](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-inking/#code-snippets)

为了便于使用，本节演示如何实现基于"行到"指令的非常基本的墨迹书写算法。如果您有兴趣开发自己的墨迹书写，您很可能会实现更智能和更外观的东西，但代码的结构将类似。

### [自定义笔划器](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-inking/#custom-stroker)

让我们从实现类开始：`CustomStroker`

```java
public class CustomStroker implements IStroker
{
    @Override
    public boolean isFill()
    {
        return false;
    }

    @Override
    public void stroke(InkPoint[] input, float width, float pixelSize, IPath output)
    {
        output.moveTo(input[0].x, input[0].y);
        for (int i=1; i< input.length; i++)
        {
            output.lineTo(input[i].x, input[i].y);
        }
    }
}
```

在这里，代码使用以下事实：iink SDK 将描边一个未填充的非闭合路径以简化代码。但是，在大多数情况下，您需要管理闭合路径，为描边创建美丽的形状。结构包含有关描边点的所有必需信息。`InkPoint`

现在，让我们实现自定义笔触器工厂：

```java
public class CustomStrokerFactory implements IStrokerFactory
{
    @Override
    public IStroker createStroker()
    {
        return new CustomStroker();
    }
}
```

现在，您所要做的就是实例化您的工厂，并将其注册到具有适当画笔名称的[渲染器](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/rendering/)：

```java
CustomStrokerFactory strokerFactory = new CustomStrokerFactory();
renderer.registerStroker("LineToBrush", strokerFactory);
```

最后，您可以在[编辑器](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/)的主题中设置笔画器：

```java
editor.setTheme("stroke { -myscript-pen-brush: LineToBrush; }");
```

就是这样！从现在起，iink SDK 将依赖自定义笔画来渲染墨笔画！

### [描边的自定义绘图](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-inking/#custom-drawing-of-the-strokes)

首先，实现[上述](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-inking/#custom-stroker)自定义笔划器以生成路径。[如所解释](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-inking/#requirements-from-iink-sdk)，iink SDK 需要各种任务的笔画包络，即使您自己绘制笔画。

接下来，创建自己的实现（您可以修改或子类 MyScript 提供的实现），以便可以使用它存储诸如点坐标、压力等信息，这些信息稍后需要呈现笔画。通过其内部缓存，iink SDK 将为您保留此信息，并在从模型中删除笔画时正确释放内存。`IPath`

下面是一个可能的实现，基于 UI 引用实现的类：`Path`

```java
public class CustomPath extends Path
{
    private InkPoint[] inkPoints;
    private float width;

    public float getWidth()
    {
        return width;
    }

    public void setWidth(float width)
    {
        this.width = width;
    }

    public InkPoint[] getInkPoints()
    {
        return inkPoints;
    }

    public void setInkPoints(InkPoint[] inkPoints)
    {
        this.inkPoints = inkPoints;
    }
}
```

You can now update your custom stroker implementation to store the information into the path:

```java
public void stroke(InkPoint[] inkPoints, float width, float pixelSize, IPath output)
{
    CustomPath customPath = (CustomPath)output;
    customPath.setInkPoints(inkPoints);
    customPath.setWidth(width);
}
```

You need to update (or subclass) the provided implementation to build your custom paths:`ICanvas`

```java
@Override
public final IPath createPath()
{
  return new CustomPath();
}
```

The method of will now be called with our paths and you can access your stored values and draw the stroke the way you want:`drawPath()``ICanvas`

```java
public void drawPath(IPath path)
{
    // Retrieve stored information
    CustomPath customPath = (CustomPath)path;
    InkPoint[] inkPoints = customPath.getInkPoints();
    float width = customPath.getWidth();

    // Custom drawing
    ...
}
```

如果要支持纹理描边，可以为您支持的每个纹理注册自定义笔画器，并存储自定义实现的必要信息，以将其考虑在内。`drawPath()`



确保笔画完全绘制在信封内。否则可能会导致呈现问题。

# 自定义识别

MyScript 的识别技术非常灵活。虽然默认配置支持常见用例，但本页说明如何微调它们以满足特定需求。

## [为什么要自定义识别？](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#why-customize-the-recognition)

MyScript 开发人员门户允许您[下载识别资产](https://developer.myscript.com/support/recognition-assets)以支持各种语言以及数学和图表用例。每个包都附带一个随时可以使用的配置，在大多数情况下都可以使用。

但是，在某些情况下，您可能需要调整这些提供的配置：

- 您需要引擎来识别默认 MyScript 词典中未包含的一些词汇表，如正确的名称。在这种情况下，您可以构建并附加[自定义词典](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#lexicon)。
- 您可以使用数学应用程序针对不同的教育水平，并希望限制 MyScript 可以识别的符号数量：这将减少一些可能的歧义（许多数学符号非常相似），并改善整体用户体验。在这种情况下，您可以构建并附加[自定义数学语法](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#math-grammar)。
- 您正在构建表单应用程序，并希望减少某些字段以仅接受某些类型的符号，如字母符号、数字甚至大写字母。在这种情况下，请考虑构建和附加[子集知识](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#subset-knowledge)。
- 您需要或多或少的识别候选项才能提供给最终用户，或者您计划为搜索目的对认可结果进行索引，并且只想考虑*前 n 名*候选项。您可以相应地[编辑配置](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#configuration-commands)。

## [识别资源](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#recognition-resources)

资源是可以附加到识别引擎的知识片段，使其能够识别给定的语言或内容。

### [字母知识](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#alphabet-knowledge)

**字母表知识 （AK）**是一种资源，它使引擎能够识别给定语言和给定书写样式的单个字符。默认配置包括每个受支持语言的草书 AK。



一次只能将单个 AK 连接到发动机。

### [语言知识](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#linguistic-knowledge)

**语言知识 （LK）**是为引擎提供给定语言的语言信息的资源。它允许识别引擎通过偏爱其词典中最有可能出现的单词来提高其准确性。默认配置包括每个受支持语言的 LK。

LK 不是强制性的，但不附加一个通常会导致显著的准确性下降。如果您不希望写完整的有意义的单词，例如，如果您计划用几个字母筛选列表，则它可能是相关的。



所有语言（但英语变体）的默认配置还附加了"辅助英语"LK，允许引擎识别目标语言和英语的组合。除了这个特殊情况，它预计不会混合语言在一起。

### [词汇](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#lexicon)

**词典**是一种资源，它列出了除了包含在语言知识资源中的内容之外可以识别的单词。

您可以[构建和附加](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/build-custom-resources/#how-to-build-resources)自己的自定义词典。

### [子集知识](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#subset-knowledge)

**子集知识 （SK）**是限制引擎应尝试识别的文本字符数的资源。因此，它对应于 AK 资源的限制。例如，在表单应用程序中，将电子邮件字段的授权字符限制为 alpha 数字字符和少数允许的标点符号非常有用。

您可以[构建和附加](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/build-custom-resources/#how-to-build-resources)自己的自定义子集知识。

### [数学语法](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#math-grammar)

**数学语法**是限制引擎应该能够处理的数学符号和规则的数量的资源。在教育使用案例中，将识别程度调整到给定的数学水平（例如，只有学生的数字和基本运算符）非常有用。

您可以[构建和附加](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/build-custom-resources/#how-to-build-resources)自己的自定义数学语法。

## [配置文件](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#configuration-files)

### [作用](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#role)

如本指南[的运行时部分](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/interactive-ink-runtime/)所述，iink SDK 使用**配置文件**，这是一种标准化的方式来提供正确的参数和知识来识别特定类型的内容。



Each recognition asset package you [download](https://developer.myscript.com/support/recognition-assets) from the Developer Portal contains its own configuration file.

### [Deployment and usage](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#deployment-and-usage)

To deploy and use a configuration, you need to:

1. Deploy the file with your application, along with all the resource files that it references (make sure that all paths are correct).`*.conf`
2. Add the folder containing the file to the paths stored in the engine configuration for the key.`*.conf``configuration-manager.search-path`
3. Depending on the content type, set the right [configuration keys](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/). For instance, to recognize text (in “Text”, “Diagram” and “Text Document” parts) you will need to ensure that the values of the and keys are matching your text configuration bundle and configuration item name (see example below).`text.configuration.bundle``text.configuration.name`

### [Syntax](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#syntax)

配置文件是具有扩展名的文本文件。它由标头（标识配置**捆绑包**）和一个或多个命名配置项（定义配置**名称**）组成，由空行分隔。`*.conf`

下面是一个示例：

```plaintext
# Bundle header
Bundle-Version: 1.3
Bundle-Name: en_US
Configuration-Script:
  AddResDir ../resources/

# Configuration item #1
Name: text
Type: Text
Configuration-Script:
  AddResource en_US/en_US-ak-cur.res
  AddResource en_US/en_US-lk-text.res
  SetTextListSize 1
  SetWordListSize 5
  SetCharListSize 1

# Configuration item #2
Name: text-no-candidate
Type: Text
Configuration-Script:
  AddResource en_US/en_US-ak-cur.res
  AddResource en_US/en_US-lk-text.res
  SetTextListSize 1
  SetWordListSize 1
  SetCharListSize 1
```

解释：

- 以 和 开头的行被视为注释并忽略。`#``!`
- 以空格开头的行是延续线。在这里，在 下收集多个命令。`Configuration-Script`
- 提供的值，如捆绑包的名称。这是 iink SDK 期望的[配置密钥](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)的可能值。在此示例中，它将是 。`Bundle-name``text.configuration.bundle``en_US`
- 为定义配置项提供的值。这是这些名称之一，iink SDK 期望作为[配置密钥](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)的可能值。在此示例中，它可以是 和 。给定引擎只能在任何时间点配置每种类型的识别器的单个配置项。`Name``text.configuration.name``text``text-no-candidate`
- 键的可能值为： 、 和 。它们对应于**核心**MyScript 技术能够识别的内容类型。`Type``Text``Math``Shape``Analyzer`

下表列出了需要为 iink SDK 提供的配置项类型，以支持其不同的[内容类型](https://developer.myscript.com/docs/interactive-ink/1.3/overview/content-types/)：

| 内容类型        | 所需的配置项类型                                             |
| :-------------- | :----------------------------------------------------------- |
| `Text`          | `Text`                                                       |
| `Math`          | `Math`                                                       |
| `Diagram`       | `Text` + `Shape` + `Analyzer`                                |
| `Drawing`       | 没有                                                         |
| `Text Document` | `Text` + `Math` + `Shape` + `Analyzer`                       |
| `Raw Content`   | `Text`[1](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#fn:1) + `Shape`[2](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#fn:2) + `Analyzer` |



必须使用空白行分隔配置项。

### [配置命令](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#configuration-commands)

下表列出了一些可能的配置命令（将放在 下）：`Configuration-Script`

| 配置项类型 | 语法                  | 参数                                              |
| :--------- | :-------------------- | :------------------------------------------------ |
| 所有       | `AddResDir DIRECTORY` | 引擎应考虑的资源文件相对路径的文件夹              |
|            | `AddResource FILE`    | 要附加的单个资源文件的名称                        |
| 文本       | `SetCharListSize N`   | 介于 1 和 20 之间的整数，表示要保留的字符候选项数 |
|            | `SetWordListSize N`   | 介于 1 和 20 之间的整数，表示要保留的单词候选项数 |
|            | `SetTextListSize N`   | 介于 1 和 20 之间的整数，表示要保留的文本候选项数 |

1. 如果对原始内容启用文本识别（请参阅[配置](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/#raw-content)[）↩](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#fnref:1)
2. 如果对原始内容启用形状识别（请参阅[配置](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/#raw-content)[）↩](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#fnref:2)

## [附加资源](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/custom-recognition/#attaching-resources)

使用 命令将 Resoucess 附加到配置项的部分。`Configuration-Script``AddResource`

例如，对于 AK，您可以编写：`en_US`

```plaintext
AddResource en_US/en_US-ak-cur.res
```



确保资源的路径正确。

# 与应用程序的撤消/重做堆栈集成

本页说明如何使 iink SDK 操作成为应用程序的撤消/重做堆栈的一部分。

## [用例](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/combined-undo-redo-stacks/#use-case)

如果应用程序基于 iink SDK 编辑器，则撤消/重做管理可开箱即用，如本指南[的编辑](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#other-edit-operations)部分所示。

但是，您的应用程序可能更为复杂，并且您可能需要将 iink SDK 操作集成到您自己的撤消/重做堆栈中。

## [概念撤消/重做堆栈](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/combined-undo-redo-stacks/#conceptual-undoredo-stack)

应用程序撤消/重做堆栈可以被视为状态的矢量，每个状态都是由特定操作产生的，但第一个都是由特定操作生成的。

在下面的示例中，当前状态是，并且由将操作应用于前一个状态的结果：`⑤``op5``④`

12345op1op2op3op4op5当前

调用撤消将恢复最后一个操作的效果。它等效于从堆栈中的当前状态移动到其左侧的状态。

在此示例中，如果当前状态为 ，则两个连续撤消将导致状态：`⑤``③`

12345op1op2op3op4op5当前

您可以注意到状态，并且仍然是堆栈的一部分。这是因为没有创建新状态，因此可以重做。`④``⑤`

调用重做在堆栈上应用下一个操作。它等效于从堆栈中的当前状态移动到其右侧的状态。

在此示例中，如果当前状态为 ，则重做将移回状态 ：`③``④`

12345op1op2op3op4op5当前

如果从状态执行新操作，则生成的状态将成为新的当前状态，并且状态将从堆栈中消失：`op6``④``⑥``⑤`

12346op1op2op3op4op6当前

## [包括 iink SDK 操作](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/combined-undo-redo-stacks/#including-iink-sdk-operations)

集成 iink SDK 的应用程序可能需要将其自身操作与[iink SDK 管理](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#other-edit-operations)的操作混合。

例如，应用程序可能会向 iink SDK 文本块下方的图层添加图像，向文本块添加描边，最后选择并删除图像。此时的预期是，如果用户按下两次撤消按钮，则第一次按下将图像恢复，第二次将删除发送到 iink SDK 的笔画。

用户按下撤消之前的情况：

123添加图像iink op删除图像当前

第一次撤消后的情况：

123添加图像iink op删除图像当前

第二次撤消后的情况：

123添加图像iink op删除图像当前

应用程序需要包括和操作 iink SDK 操作的效果。



交互式墨迹生成状态以蓝色背景显示在不同的示例中。

## [管理 iink SDK 操作](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/combined-undo-redo-stacks/#managing-iink-sdk-operations)

挑战在于 iink SDK 维护其自己的内部撤消/重做堆栈，并且主机应用程序无法访问它包含的操作。但是，可以查询 iink SDK 来获取有关其内部堆栈状态的信息，以实现所需的行为。

从现在开始，您应该考虑应用程序不知道 iink 操作实际执行的操作（实际上并不重要）。让我们展示一下它如何仍然能够正确管理其撤消/重做堆栈。

让我们回到示例。如何获取此堆栈？

123添加图像iink op删除图像当前

iink SDK 编辑器提供以下方法：

- `getUndoStackIndex()`- 在**内部 iink 撤消/重做堆栈中**标识当前状态的光标的位置。
- `getPossibleUndoCount()`- 当前可以撤消的操作数（因此 = ）。`getPossibleUndoCount()``getUndoStackIndex()`

您可以通过观察 的增量来知道 iink SDK 何时添加新的"可撤消"操作。可以通过在[`内容更改（）`通知](https://developer.myscript.com/docs/interactive-ink/1.3/android/fundamentals/editing/#monitoring-changes-in-the-model)后调用返回的值比较以前存储的值。`getUndoStackIndex()``getUndoStackIndex()`

让我们看看它如何应用于该示例。假设您已设置了 iink SDK 编辑器，并附加了"文本"部分。由于未执行任何操作，等于 0。首先，添加图像。因为它在 iink SDK 之外完成，不调用，也不会递增。`getUndoStackIndex()``contentChanged()``getUndoStackIndex()`

应用程序和 iink SDK 编辑器堆栈分别如下所示：

1添加图像当前当前应用：iink编辑器：堆栈索引 = 0

现在，您将笔画发送到 iink SDK 编辑器。

您可能会收到一个或多个通知并测试增量。如果笔画未作为手势丢弃（不应！`contentChanged()``getUndoStackIndex()``getUndoStackIndex()`

1添加图像当前当前1iink op应用：iink编辑器：stackIndex = 1

如你所知，iink SDK 内部堆栈添加了新的状态。您可以将新状态**添加到应用程序堆栈中**，该状态对应于不透明 iink 操作的效果：

12添加图像iink：" 1"当前当前1iink op应用：iink编辑器：stackIndex = 1

iink 操作存储到应用程序堆栈后获取的值。查看从通知获取的值是否已更改并做出相应反应非常有用。`getUndoStackIndex()``contentChanged()`

您现在可以在 iink SDK 之外选择和删除映像。与第一个操作一样，不调用并且不递增：`contentChanged()``getUndoStackIndex()`

123添加图像iink：" 1"删除图像当前当前1iink op应用：iink编辑器：stackIndex = 1

现在，让我们撤消。当当前应用程序状态由应用程序级操作产生时，应用程序应还原映像：

123添加图像iink：" 1"删除图像当前当前1iink op应用：iink编辑器：stackIndex = 1

让我们再次撤消。当前状态由内部 iink SDK 操作产生。因此，在应用程序堆栈上移动光标时，应调用**iink SDK 编辑器**：`undo()`

123添加图像iink：" 1"删除图像当前当前1iink op应用：iink编辑器：堆栈索引 = 0

现在，如果要重做，首先调用**iink SDK 编辑器**并将光标向右移动，因为重做的操作是 iink 操作（增量为 1，但由于它来自重做操作，因此不应将其视为通过清除堆栈来阻止下一次重做的新操作）。再次重做，这一次管理应用程序端的图像删除。`redo()``getUndoStackIndex()`



iink SDK 撤消堆栈会不时部分清除，以控制内存消耗。因此，它有时可能无法还原应用程序级堆栈已知的所有状态。要知道撤消是否实际可行，应检查 的值，该值告诉您 iink SDK 可以从其当前内部状态撤消多少个步骤。`getPossibleUndoCount()`

## [管理多个 iink SDK 编辑器](https://developer.myscript.com/docs/interactive-ink/1.3/android/advanced/combined-undo-redo-stacks/#managing-several-iink-sdk-editors)

每个内容部件都有自己的撤消/重做堆栈。因此，如果您使用多个 iink SDK 编辑器，则必须将每个 iink 撤消/重做操作关联到编辑器，以便知道哪个编辑器应执行应用程序级堆栈中引用的撤消或重做操作。

# 配置

交互式墨迹 SDK 是一个灵活的工具包，其默认配置可以进行调整以满足不同的需求。此页列出了可用选项、其默认值和使用情况。



在本机平台上，您可以通过对象访问 。有关更多说明，请参阅指南的交互式墨迹运行时页面。`Configuration``Engine`

在下表中，请注意语法如何允许检索另一个键的值。`${KEY_NAME}`

## [一般](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/#general)

| 关键                                | 类型       | 默认值  | 描述                                                         |
| :---------------------------------- | :--------- | :------ | :----------------------------------------------------------- |
| `configuration-manager.search-path` | 字符串数组 | <空>    | 存储配置文件 （） 的目录列表。`*.conf`                       |
| `content-package.temp-folder`       | 字符串     | <空>    | 应提取内容包的临时文件夹的位置[1](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/#fn:1).如果为空，该文件夹将放置在相应的内容包旁边。 |
| `convert.convert-on-double-tap`     | 布尔       | `true`  | 如果 ，双击块将转换它。`true`                                |
| `debug.log-file`                    | 字符串     | <空>    | 应存储调试日志的文件的路径。                                 |
| `export.image-max-size`             | 数量       | 4096    | 导出图像的最大宽度和高度                                     |
| `export.image-resolution`           | 数量       | 300     | 导出的图像的分辨率（以 dpi 表示）。                          |
| `export.jiix.bounding-box`          | 布尔       | `true`  | 如果 ，JIIX 导出将包含导出项的边界框。`true`                 |
| `export.jiix.strokes`               | 布尔       | `true`  | 如果 ，JIIX 导出将包含详细的墨迹信息。`true`                 |
| `export.jiix.glyphs`                | 布尔       | `true`  | 如果 ，JIIX 导出将包括转换后的字形。`true`                   |
| `export.jiix.primitives`            | 布尔       | `true`  | 如果 ，JIIX 导出将包括转换的形状基元。`true`                 |
| `export.jiix.style`                 | 布尔       | `false` | 如果 ，JIIX 导出将包含样式信息。注意**将仅导出动态样式**，而不是编辑器级样式表`true` |
| `export.jiix.text.chars`            | 布尔       | `false` | 如果 ，JIIX 导出将包含详细的字符信息。`true`                 |
| `export.jiix.text.words`            | 布尔       | `true`  | 如果 ，JIIX 导出将包含详细的单词信息。`true`                 |
| `export.temporary-file`             | 字符串     | <空>    | 临时导出文件的路径。如果未设置，临时文件将创建与相应的内容包一起。 |
| `lang`                              | 字符串     | `en_US` | 定义编辑器中使用的语言。                                     |
| `renderer.debug.draw-image-boxes`   | 布尔       | `false` | 如果 ，将显示图像的边界。`true`                              |
| `renderer.debug.draw-text-boxes`    | 布尔       | `false` | 如果 显示单词（文本）或字符（用于数学）的边界。`true`        |
| `gesture.enable`                    | 布尔       | `true`  | 如果 ，iink SDK 将在写入时尝试检测[手势](https://developer.myscript.com/docs/interactive-ink/1.3/overview/gestures/)。`true` |

## [文本](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/#text)

| 关键                        | 类型   | 默认值    | 描述                                                         |
| :-------------------------- | :----- | :-------- | :----------------------------------------------------------- |
| `text.configuration.bundle` | 字符串 | `${lang}` | 要使用的配置捆绑包（文件名称）。`*.conf`                     |
| `text.configuration.name`   | 字符串 | `text`    | 包中的配置名称（文件中的配置）。`*.conf`                     |
| `text.margin.left`          | 数量   | 15        | 从零件左侧到文本边界框左侧的边距（用于重排）。               |
| `text.margin.right`         | 数量   | 15        | 从零件右侧到文本边界框右侧的边距（用于重排）。               |
| `text.margin.top`           | 数量   | 10        | 从零件顶部到文本边界框顶部的边距（用于重排）。               |
| `text.guides.enable`        | 布尔   | `true`    | 如果 显示 参考线并用于转换和重排操作。默认行间距为 10 mm，可以通过选择类和值[进行调整](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#text)。`true``.text``font-size``line-height` |



所有这些参数只影响"文本"内容类型，而不影响"文本文档"。`text.*`

## [数学](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/#math)

| 关键                                 | 类型   | 默认值      | 描述                                                         |
| :----------------------------------- | :----- | :---------- | :----------------------------------------------------------- |
| `math.configuration.bundle`          | 字符串 | `math`      | 要使用的配置捆绑包（文件名称）。`*.conf`                     |
| `math.configuration.name`            | 字符串 | `standard`  | 包中的配置名称（文件中的配置）。`*.conf`                     |
| `math.margin.bottom`                 | 数量   | 10          | 从零件底部到数学表达式边界框底部的边距（用于转换操作）。     |
| `math.margin.left`                   | 数量   | 15          | 从零件左侧到数学表达式边界框左侧的边距（用于转换操作）。     |
| `math.margin.right`                  | 数量   | 15          | 从零件右侧到数学表达式边界框右侧的边距（用于转换操作）。     |
| `math.margin.top`                    | 数量   | 10          | 从零件顶部到数学表达式边界框顶部的边距（用于转换操作）。     |
| `math.solver.angle-unit`             | 字符串 | `deg`       | 解算器中的角度计算单位：它必须是（度）或（弧度）。`deg``rad` |
| `math.solver.decimal-separator`      | 字符串 | `.`         | 十进制分隔符（通常或 ）。`.``,`                              |
| `math.solver.enable`                 | 布尔   | `true`      | 如果 ，则转换时显示解算器结果。`true`                        |
| `math.solver.fractional-part-digits` | 数量   | 3           | 要在解算器计算结果中显示的小数数。                           |
| `math.solver.fraction-mode`          | 字符串 | `decimal`   | 显示解算器结果的方式：（例如"1.5"），（例如"3/2"），或（例如"11/2"）。`decimal``rational``mixed` |
| `math.solver.options`                | 字符串 | `algebraic` | 用于让解算器可能修改表达式的结构以获取可计算的内容。在任何情况下都用于保留输入的结构。`numeric``algebraic` |
| `math.solver.rounding-mode`          | 字符串 | `half up`   | 使用显示解算器的舍入方法结果：它必须是 或 。`half up``truncate` |

## [图](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/#diagram)

| 关键                                    | 类型   | 默认值     | 描述                                                         |
| :-------------------------------------- | :----- | :--------- | :----------------------------------------------------------- |
| `diagram.configuration.analyzer.bundle` | 字符串 | `diagram`  | 要使用的配置捆绑包（文件名称）。`*.conf`                     |
| `diagram.configuration.analyzer.name`   | 字符串 | `analyzer` | 包中的配置名称（文件中的配置）。`*.conf`                     |
| `diagram.configuration.shape.bundle`    | 字符串 | `diagram`  | 要使用的配置捆绑包（文件名称）。`*.conf`                     |
| `diagram.configuration.shape.name`      | 字符串 | `shape`    | 包中的配置名称（文件中的配置）。`*.conf`                     |
| `diagram.configuration.text.bundle`     | 字符串 | `${lang}`  | 要使用的配置捆绑包（文件名称）。`*.conf`                     |
| `diagram.configuration.text.name`       | 字符串 | `text`     | 包中的配置名称（文件中的配置）。`*.conf`                     |
| `diagram.convert.edge`                  | 布尔   | `true`     | 如果 ，在转换时，图边将转换为整洁的原始语。`true`            |
| `diagram.convert.node`                  | 布尔   | `true`     | 如果 ，在转换时，图节点将转换为整洁的形状。`true`            |
| `diagram.convert.text`                  | 布尔   | `true`     | 如果 ，在转换时，关系图文本将转换为类型集。`true`            |
| `diagram.enable-sub-blocks`             | 布尔   | `true`     | 如果 ，关系图块包含描述关系图内容的子块。`true`              |
| `diagram.eraser.show`                   | 布尔   | `true`     | 如果 ，在橡皮擦位置显示光晕。`true`                          |
| `diagram.session-time`                  | 数量   | 1000       | 最后一个笔向上事件和后续通知之间的时间间隔（以毫秒为单位）。`contentChanged()` |

## [绘图](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/#drawing)

| 关键                                  | 类型 | 默认值  | 描述                                                         |
| :------------------------------------ | :--- | :------ | :----------------------------------------------------------- |
| `drawing.eraser.radius`               | 数量 | 3       | 将橡皮擦工具的半径设置为 mm。                                |
| `drawing.eraser.erase-entire-strokes` | 布尔 | `false` | 如果 ，橡皮擦删除它接触的任何笔画，否则它只会擦除其轨迹中的墨迹部分。`true` |

## [原始内容](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/#raw-content)

| 关键                                        | 类型   | 默认值        | 描述                                                         |
| :------------------------------------------ | :----- | :------------ | :----------------------------------------------------------- |
| `raw-content.configuration.analyzer.bundle` | 字符串 | `raw-content` | 用于墨迹分析的配置捆绑包（文件名称）。`*.conf`               |
| `raw-content.configuration.analyzer.name`   | 字符串 | `text-block`  | 捆绑包内墨迹分析的配置名称（文件中的配置）。`*.conf`         |
| `raw-content.configuration.shape.bundle`    | 字符串 | `diagram`     | 用于形状识别的配置捆绑包（文件名称）。`*.conf`               |
| `raw-content.configuration.shape.name`      | 字符串 | `shape`       | 捆绑包中形状识别的配置名称（文件中的配置）。`*.conf`         |
| `raw-content.configuration.text.bundle`     | 字符串 | `${lang}`     | 用于文本识别的配置捆绑包（文件名称）。`*.conf`               |
| `raw-content.configuration.text.name`       | 字符串 | `text`        | 捆绑包内文本识别的配置名称（文件中的配置）。`*.conf`         |
| `raw-content.eraser.radius`                 | 数量   | 3             | 将橡皮擦工具的半径设置为 mm。                                |
| `raw-content.eraser.erase-entire-strokes`   | 布尔   | `false`       | 如果 ，橡皮擦删除它接触的任何笔画，否则它只会擦除其轨迹中的墨迹部分。`true` |
| `raw-content.eraser.show`                   | 布尔   | `true`        | 如果 ，在橡皮擦位置显示光晕。`true`                          |
| `raw-content.recognition.shape`             | 布尔   | `false`       | 如果设置为 ，非文本将识别为形状和 JIIX 导出中可用的结果。`true` |
| `raw-content.recognition.text`              | 布尔   | `false`       | 如果设置为 ，将识别文本块，并且结果在 JIIX 导出中可用。`true` |

## [文本文档](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/#text-document)

当前没有直接应用于文本文档的配置选项。预设值如下所示：

- 文本捆绑包为 ，`${lang}`
- 文本配置名称为 ，`text`
- 图形状和分析器捆绑包为 ，`diagram`
- 关系图形状配置名称为 ，`shape`
- 关系图分析器配置名称为 ，`analyzer`
- 数学包是 ，`math`
- 数学配置包是 。`standard`

由于无法更改这些配置包和项目，如果要使用这种类型的零件，请确保这些配置捆绑包和项目可用。

1. 此设置仅影响修改后创建或打开的包。[↩](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/#fnref:1)

# JIIX 格式参考

JSON 交互式墨水 eXchange 格式 （JIIX） 版本 2 的参考。

## [内容](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#content)

JIIX 是一种**交换格式**，用于导出、共享和重新导入交互式墨迹模型的内部语义。

因此，它旨在承载有关：

- **内容**- 笔画、字形和图形基元
- **内容的语义解释**，包括列表
- **样式信息**- 装饰、颜色、宽度、字体等。

从 iink SDK 导出 JIIX 时，根据用例，有时可能只想检索此信息的一部分。这在配置级别通过以下键进行管理：

- `export.jiix.strokes`- 导出墨迹描边
- `export.jiix.glyphs`- 导出转换后的字形
- `export.jiix.primitives`- 导出形状基元（线条、圆圈等）
- `export.jiix.style`- 导出详细的样式信息（颜色、宽度、字体等）
- `export.jiix.text.chars`- 导出有关文本解释中字符的详细信息
- `export.jiix.text.words`- 导出有关文本解释中单词的详细信息

有关这些参数（包括默认值）的详细信息，请参阅[配置引用](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)。

## [版本](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#versioning)

当前文档符合的格式版本由**JSON 文档根****`的版本`**属性提供（因为文档的根对应于公开[的内容块层次结构](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#structure)的根块，版本属性属于此根块）。

| 描述            | 内容                       | 注意                                                         |
| :-------------- | :------------------------- | :----------------------------------------------------------- |
| JIIX 格式的版本 | 标识格式的当前迭代的字符串 | 此属性是使用 iink SDK 1.3 添加的。1.3 之前的 JIIX 文档没有此属性 |

例如，如果根块是"文本"块，我们将具有类似：

```json
{
 "version": "2",
 "type": "Text",
 "bounding-box": { ... },
 "label": "Hello world!",
 "words": [ ... ],
 "id": "MainBlock"
}
```

## [单元系统](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#unit-system)

联合执行文件中未显式提供单位。它们应被理解为**模型单位**，即**毫米**。然后，屏幕上 JIIX 文档的实际呈现将取决于 dpi 和用于配置渲染器的任何其他参数（缩放、偏移）。

## [结构](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#structure)

### [块层次结构](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#block-hierarchy)

JIIX 文档组织为 JSON 对象（此页中的"块"）的**层次结构**，这些对象镜像内容部件的块层次结构。每个对象都有一个特定的**`类型`**字符串属性，将其标识为文本块、关系图块、数学节点等，并定义块语义。

例如，简单关系图可以聚合文本标签和矩形节点：

```json
{
 "type": "Diagram",
 "elements": [ {
   "type": "Text",
   ...
  }, {
   "type": "Node",
   "kind": "rectangle",
   ...
  } ],
 ...
}
```

此语义，进而定义子块的聚合方式。例如 ：

- A block will host an array of “Diagram Item” blocks under its property.`Diagram``elements`
- A block will host an array of “Math Node” blocks under its property.`Math``expressions`
- A generic block will host its sub-blocks under a property.`Container``children`
- …



To know the precise semantics of a given type of block, please refer to its detailed description below.

### [Properties common to blocks](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#properties-common-to-blocks)

Whatever their types, all blocks share the following common properties:

| Property           | Description                                           | Content                                                      | Note                                                         |
| :----------------- | :---------------------------------------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| **`id`**           | Block unique reference in the context of the document | A string                                                     |                                                              |
| **`bounding-box`** | Extent of the block                                   | `x`, , , - 4 numerical values defining a rectangle which upper-left corner is positioned at coordinates (, ) and of size (, `y``width``height``x``y``width``height`) | Present in the JIIX export when [configuration](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/) is `export.jiix.bounding-box``true` |

For example, a simple drawing block can be represented as:

```json
{
 "type": "Drawing",
 "id": "MainBlock",
 "bounding-box": {
  "x": 20.43125,
  "y": 31.272942,
  "width": 9.9375,
  "height": 8.9725456
 },
 ...
}
```

Other potential properties depend on the **`type`** of the block. Refer to the “[blocks](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#blocks)” section for more details.

### [Block content description](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#block-content-description)

Block content is described using [items](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#items), which represent what is actually visible when rendering the model.

## [Items](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#items)

Items are used to describe the content of blocks in terms of ink, glyphs or shape primitives.

Like blocks, items share common properties:

| Property   | Description                                           | Content                           |
| :--------- | :---------------------------------------------------- | :-------------------------------- |
| **`type`** | Type of the item                                      | `stroke`, , or `line``arc``glyph` |
| **`id`**   | Item unique reference in the context of the document. | A string                          |

### [Stroke item](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#stroke-item)

A item represents a standalone portion of ink, that is to say the trajectory of a writing tool between a pointer down and the corresponding pointer up.`stroke`

It has the following specific properties:

| Property        | Description                                                  | Content                                 |
| :-------------- | :----------------------------------------------------------- | :-------------------------------------- |
| **`timestamp`** | Precise date and time of the pointer down                    | Example: `"2018-11-28 09:31:43.893000"` |
| **`X`**         | X coordinates of the different points of the stroke, ordered from pointer down to pointer up | An array of numbers                     |
| **`Y`**         | Y coordinates of the different points of the stroke, ordered from pointer down to pointer up | An array of numbers.                    |
| **`F`**         | Force (a.k.a pressure) of the different points of the stroke, ordered from pointer down to pointer up | An array of numbers                     |
| **`T`**         | Time offset of the different points of the stroke in ms relatively to the timestamp of the stroke, ordered from pointer down to pointer up | An array of numbers                     |

Example:

```json
{
 "type": "stroke",
 "id": "0000000001002300ff00",
 "timestamp": "2018-11-28 09:31:43.893000",
 "X": [ 21.43125, 21.629688, 22.026562, 22.621876, 23.614063, 24.606251, 25.003124, 25.796875, 26.789062, 26.987499, 27.582813, 28.178125, 28.376562, 28.773438, 28.971874, 29.170313, 29.36875, 29.36875 ],
 "Y": [ 39.245487, 39.046272, 38.448627, 37.651764, 36.8549, 35.858822, 35.460392, 34.663528, 33.866665, 33.66745, 33.468235, 32.870586, 32.671371, 32.671371, 32.472157, 32.472157, 32.272942, 32.272942 ],
 "F": [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ],
 "T": [ 0, 168, 176, 187, 196, 206, 215, 224, 232, 241, 249, 258, 266, 274, 276, 289, 296, 305 ]
}
```



中的元素数必须**完全**相同。`X``Y``T``F`

### [行项目](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#line-item)

项表示转换的线基元，例如多边形的边缘。`line`

它具有以下特定属性：

| 财产            | 描述                             | 内容                                   |
| :-------------- | :------------------------------- | :------------------------------------- |
| **`timestamp`** | 转换为此基元划算的描边的时间戳。 | 例子：。`"2018-11-29 10:03:05.980000"` |
| **`x1`**        | 定义线的第一个点的 X 坐标        | 数字                                   |
| **`y1`**        | 定义线的第一个点的 Y 坐标        | 数字                                   |
| **`x2`**        | 定义线的第二个点的 X 坐标        | 数字                                   |
| **`y2`**        | 定义线的第二个点的 Y 坐标        | 数字                                   |

例子：

```json
{
 "type": "line",
 "id": "00001d0001000300ff00",
 "timestamp": "2018-11-29 10:03:05.980000",
 "x1": 67.351799,
 "y1": 72.70636,
 "x2": 74.252617,
 "y2": 60.756866
}
```

### [弧项目](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#arc-item)

项表示转换的弧基元，例如关系图中的曲线连接符或椭圆的一部分。`arc`

它具有以下特定属性：

| 财产             | 描述                             | 内容                                 |
| :--------------- | :------------------------------- | :----------------------------------- |
| **`timestamp`**  | 转换为此基元划算的描边的时间戳。 | 例子：`"2018-11-29 10:03:05.980000"` |
| **`cx`**         | 弧中心的 X 坐标                  | 数字                                 |
| **`cy`**         | 弧中心的 Y 坐标                  | 数字                                 |
| **`rx`**         | x 轴或半主半径                   | 数字（必须为正数）                   |
| **`ry`**         | y 轴或半小半径                   | 数字（必须为正数）                   |
| **`phi`**        | x 轴旋转角度                     | 数字                                 |
| **`startAngle`** | 起始角度（拉伸和旋转之前）       | 数字                                 |
| **`sweepAngle`** | 扫描角度（拉伸和旋转之前）       | 数字                                 |

例子：

```json
{
 "type": "arc",
 "id": "00001c0001008100ff00",
 "timestamp": "2018-11-29 10:03:02.108000",
 "cx": 34.332874,
 "cy": 71.93309,
 "rx": 9.3729343,
 "ry": 9.3729343,
 "phi": 0,
 "startAngle": 0,
 "sweepAngle": 6.2831855
}
```

### [字形项目](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#glyph-item)

项表示转换的类型集字符。`glyph`

它具有以下特定属性：

| 财产                     | 描述                                      | 内容                                 | 注意                                   |
| :----------------------- | :---------------------------------------- | :----------------------------------- | :------------------------------------- |
| **`timestamp`**          | 转换为此字形的笔画的时间戳                | 例子：`"2018-11-28 13:37:03.514000"` |                                        |
| **`label`**              | 由字形表示的字符                          | 例子：`"B"`                          |                                        |
| **`baseline`**           | 基线位置                                  | 数字                                 | 可选（不适用于数学上下文中存在的字形） |
| **`x-height`**           | x 高度                                    | 数字                                 | 可选（不适用于数学上下文中存在的字形） |
| **`square-root-ratio`**  | 字形大小与平方根的"V"形状部分之间的水平比 | 数字                                 | 仅适用于平方根                         |
| **`left-side-bearing`**  | 字形左侧轴承                              | 数字                                 |                                        |
| **`right-side-bearing`** | 字形右侧轴承                              | 数字                                 |                                        |

例子：

```json
{
 "type": "glyph",
 "id": "00003c0001000700ff00",
 "timestamp": "2018-11-28 13:37:03.514000",
 "bounding-box": { ... },
 "label": "B",
 "baseline": 1.0000001,
 "x-height": 0.73378384,
 "left-side-bearing": -0.21175167,
 "right-side-bearing": 1.0937916
}
```

## [文本口译](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#text-interpretation)

iink SDK 解释的文本由单词和字符对象表示为[文本块](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#text-block)的一部分。

### [Word 对象](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#word-object)

单词对象表示 MyScript 引擎对单词的识别。请注意，要在 JIIX 导出中获取此类解释，您需要将配置选项设置为 。`export.jiix.text.words``true`

它具有以下属性：

| 财产               | 描述                               | 内容                                                         | 注意                                                         |
| :----------------- | :--------------------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| **`label`**        | 与这个词关联的顶级识别结果         | 字符串                                                       |                                                              |
| **`candidates`**   | 与这个词关联的认可候选者列表       | 字符串数组                                                   |                                                              |
| **`bounding-box`** | 这个词的范围。                     | `x`， - 4 个数值定义左上角位于坐标 （、 ） 和大小 （， ） 的矩形。`y``width``height``x``y``width``height` | [当配置](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)为 时，JIIX 导出中存在。`export.jiix.bounding-box``true` |
| **`items`**        | 构成单词的墨水和/或字形。          | [笔画](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#stroke-item)和/或[字形](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#glyph-item)项数组 | 当[配置为](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)时，JIIX 导出中仅存在描边，而 Glys 仅在[配置为](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)`export.jiix.strokes``true``export.jiix.glyphs``true` |
| **`first-char`**   | 此单词中包含的第一个字符的索引。   | 一个整数，表示[文本块](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#text-block)中[字符对象的](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#character-object)索引。 | 仅在 JIIX 导出中存在，或[配置为](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)`export.jiix.text.chars``export.jiix.style``true` |
| **`last-char`**    | 此单词中包含的最后一个字符的索引。 | 一个整数，表示[文本块](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#text-block)中[字符对象的](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#character-object)索引 | 仅在[将](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)JIIX 导出配置为`export.jiix.text.chars``true` |

例子：

```json
{
 "label": "hello",
 "candidates": [ "hello", "Hello", "hella", "bello", "Lello" ],
 "first-char": 0,
 "last-char": 4,
 "bounding-box": { ... },
 "items": [ ... ]
}
```

### [字符对象](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#character-object)

字符对象表示 MyScript 引擎对字符的识别。请注意，要在 JIIX 导出中获取此类解释，您需要将配置选项设置为 。`export.jiix.text.chars``true`

它具有以下属性：

| 财产               | 描述                       | 内容                                                         | 注意                                                         |
| :----------------- | :------------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| **`label`**        | 与此字符关联的识别结果     | 字符串                                                       |                                                              |
| **`grid`**         | 突出显示与此字符关联的区域 | 4 个点数组，每个点包含和浮动点坐标`x``y`                     |                                                              |
| **`bounding-box`** | 字符的范围                 | `x`， ， - 4 个数值定义左上角位于坐标 （， ） 和大小的矩形 （，`y``width``height``x``y``width``height`) | [配置](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)时在 JIIX 导出中存在`export.jiix.bounding-box``true` |
| **`items`**        | 构成角色的墨水和/或字形    | [笔画](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#stroke-item)和/或[字形](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#glyph-item)项数组 | 仅当[配置为](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)时，JIIX 导出中才会存在描边，而 Glys 仅在[配置为](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)时才存在。`export.jiix.strokes``true``export.jiix.glyphs``true` |
| **`word`**         | 包含此字符的单词的索引     | 整数                                                         | 仅在 JIIX 导出中存在，当[配置为](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)`export.jiix.text.words``true` |

例子：

```json
{
  "label": "h",
  "word": 0,
  "grid": [ {
    "x": 18.875834,
    "y": 31.736748
   }, {
    "x": 25.118258,
    "y": 31.736748
   }, {
    "x": 25.118258,
    "y": 44.957951
   }, {
    "x": 18.875834,
    "y": 44.957951
   } ],
  "bounding-box": { ... },
  "items": [ ... ]
 }
```

## [风格](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#style)

JIIX 格式可以包含样式信息。其中包括：

- 显式分配给笔的 CSS 属性（动态样式）
- 分配给笔的样式类（笔样式类）
- 检测到修饰时，iink SDK 会自动设置类和样式。



不会导出编辑器本地的主题。

如果要导出内容，则需要将[配置](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)密钥设置为获取样式信息。`export.jiix.style``true`

### [项目跨度样式](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#item-span-styling)

像["绘图"](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#drawing-block)和/[原始内容项](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#raw-content-item-block)这样的块可以被视为笔画的有序集合。此类集合可以通过"项范围"的定义进行样式设置，每个范围将特定样式与一系列项相关联。`text``non-text`

项范围具有以下属性：

| 财产             | 描述                              | 内容             |
| :--------------- | :-------------------------------- | :--------------- |
| **`first-item`** | 范围中第一项的索引                | 数字（正数或空） |
| **`last-item`**  | 范围中最后一项的索引              | 数字（正数或空） |
| **`class`**      | 附加到范围中的项的 CSS 类的名称   | 字符串           |
| **`style`**      | "覆盖"任何默认样式的内联 CSS 样式 | 字符串           |

例如，如果我们将 2 个笔画的笔次程设置为"greenThickPen"，则再写 2 个笔画，没有笔样式类，但笔样式设置为"颜色：#FF324233"，我们获得类似：

```json
{
  "first-item": 0,
  "last-item": 1,
  "class": "greenThickPen"
}
```

和

```json
{
 "first-item": 2,
 "last-item": 3,
 "style": "color: #FF324233"
}
```

请注意，如果应用默认样式，项可能包含和指示，或者不包含任何指示。`class``style`

### [文本跨距样式](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#text-span-styling)

[文本块](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#text-block)可以被视为有序的字符集合。此类集合可以通过"字符范围"的定义进行样式设置，每个范围将特定样式与一系列字符相关联。

项范围具有以下属性：

| 财产             | 描述                              | 内容             |
| :--------------- | :-------------------------------- | :--------------- |
| **`first-char`** | 范围中第一个字符的文本中的索引    | 数字（正数或空） |
| **`last-char`**  | 范围中最后一个字符的文本中的索引  | 数字（正数或空） |
| **`class`**      | 附加到范围中字符的 CSS 类的名称   | 字符串           |
| **`style`**      | "覆盖"任何默认样式的内联 CSS 样式 | 字符串           |

例如，用手势下划下划线的文本可能会具有以下样式：

```json
{
 "first-char": 0,
 "last-char": 12,
 "class": "text-emphasis1",
 "style": "color: #000000FF; -myscript-text-decoration-color: #000000FF; -myscript-text-decoration-background-color: #FFED2666"
}
```

### [节点样式](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#nodes-styling)

[数学](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#math-node-block)和[图表节点](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#diagram-item-blocks)等块以及[关系图连接器](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#diagram-item-blocks)都是独立样式的。

它们可以直接具有以下属性：

| 财产        | 描述                                  | 内容   |
| :---------- | :------------------------------------ | :----- |
| **`class`** | 附加到节点的 CSS 类的名称             | 字符串 |
| **`style`** | 内联 CSS 样式"覆盖"节点的任何默认样式 | 字符串 |

例如，数学节点的样式可以如下：

```json
{
 "type": "number",
 "id": "math/170",
 "label": "3",
 "value": 3,
 "items": [ ... ],
 "bounding-box": { ... },
 "class": "greenThickPen"
}
```

## [Blocks](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#blocks)

This section lists all available blocks of the hierarchy, their properties and particularities, if any.

### [Container block](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#container-block)

A block of type groups children blocks together.`Container`

It has the following specific property:

| 财产           | 描述               | 内容   |
| :------------- | :----------------- | :----- |
| **`children`** | 此容器块中的块列表 | 块数组 |

例如，在 JIIX 导出的由两段文本组成的"文本文档"部分中，每个段落将对应于一个文本块，并且两个段落将分组为同一容器块的子项：

```json
{
 "type": "Container",
 "id": "2135",
 "bounding-box": { ... },
 "children": [ {
   "type": "Text",
   ...
  }, {
   "type": "Text",
   ...
  } ],
 ...
}
```



没有假设子块的类型。

### [图表块](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#diagram-block)

类型块将单个关系图的不同内部块组合在一起。`Diagram`

它具有以下特定属性：

| 财产           | 描述               | 内容                                                         |
| :------------- | :----------------- | :----------------------------------------------------------- |
| **`elements`** | 识别图表项的数组。 | [图表项块](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#diagram-item-blocks)的数组 |

例如，关系图可以由文本标签和对应于矩形的关系图 Node 组成：

```json
{
 "type": "Diagram",
 "id": "9824",
 "bounding-box": { ... },
 "elements": [ {
   "type": "Text",
   ...
  }, {
   "type": "Node",
   "kind": "rectangle",
   ...
  } ],
 ...
}
```

### [图表项块](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#diagram-item-blocks)

关系图项块统**一组成不同类型的块系列**，描述关系图的语义结构：连接器、文本块、几何形状等。没有实际的"图表项"类型。

这些块具有以下常见属性：

| 财产         | 描述                              | 内容                                                         | 注意                                                         |
| :----------- | :-------------------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| **`type`**   | 图表项类型                        | `Node`或`Edge``Polyedge``Text`                               |                                                              |
| **`parent`** | 关系图项父项（如果有）            | 图表项数字 ID                                                |                                                              |
| **`items`**  | 构成项目的墨迹和/或转换的形状基元 | [描边](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#stroke-item)、[线](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#line-item)和/或[圆弧](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#arc-item)项数组 | 仅当[配置为](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)时，JIIX 导出中才会存在描边，当[配置为](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)时，直线和圆弧才存在，`export.jiix.strokes``true``export.jiix.primitives``true` |

关系图节点和连接器（即具有类型 或 ） 将获得以下样式属性：`node``edge``polyedge`

| 财产        | 描述                                  | 内容   |
| :---------- | :------------------------------------ | :----- |
| **`class`** | 附加到节点的 CSS 类的名称             | 字符串 |
| **`style`** | 内联 CSS 样式"覆盖"节点的任何默认样式 | 字符串 |

当[配置为](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)时，样式仅在然后 JIIX 导出中存在。`export.jiix.style``true`

例子：

```json
{
 "id": 97,
 "type": "Node",
 "parent": 12,
 "bounding-box": { ... },
 "items": [ ... ],
 ... specific properties ...
}
```



尽管关系图项块具有与其他块一样的属性，但它们的标识符是数字而不是字符串。`id`

**• 图表`节点`块**

类型的关系图项与特定形状、可选标签相关联，并可承载子项。这由以下属性建模：`Node`

| 财产           | 描述                                      | 内容                                                     |
| :------------- | :---------------------------------------- | :------------------------------------------------------- |
| **`kind`**     | 关系图项子类型。                          | `rectangle`或`rhombus``polygon``circle``ellipse``doodle` |
| **`label`**    | 描述与项关联的标签的类型图项的 ID。`Text` | 图表项数字 ID                                            |
| **`children`** | 与项关联的子关系图项数组                  | 图表项数字 ID 数组                                       |

根据其"种类"，项目将具有特定属性：

- 如果`"类型"："矩形"`
  - `x`- 矩形左上角的 X 坐标。
  - `y`- 矩形左上角的 X 坐标。
  - `width`- 矩形的宽度。
  - `height`- 矩形的高度。
- 如果`"善良"："菱形"`
  - `points`- 包含描述菱形的 4 个 *的数组。`x``y`
- 如果`"好"："多边形"`
  - `points`- 描述多边形的 {、* 点的数组。`x``y`
- 如果`"善良"："圆"`
  - `cx`- 圆中心的 X 坐标。
  - `cy`- 圆中心的 Y 坐标。
  - `r`- 圆的半径。
- **如果`"类型"："椭圆"：`**轴对齐椭圆。
  - `cx`- 椭圆中心的 X 坐标。
  - `cy`- 椭圆中心的 Y 坐标。
  - `rx`- 椭圆的 X 半径。
  - `ry`- 椭圆的 Y 半径。
- 如果`"善良"："涂鸦"`
  - *没有特定属性描述涂鸦。*
  - *注意*：由于涂鸦未转换，因此永远不会包含形状基元。`items`

例如，以下节点表示与文本标签关联的关系图中的矩形：

```json
{
 "type": "Node",
 "kind": "rectangle",
 "label": 24,
 "children": [ 64, 72, 78 ],
 "id": 97,
 "bounding-box": { ... },
 "items": [ ... ],
 "x": 11.43108,
 "y": 21.065617,
 "width": 54.700756,
 "height": 18.451683
}
```

**➤ Diagram `Edge` block**

A diagram item of type connects other diagram items.`Edge`

| Property              | Description                                              | Content                                       | Note                                                         |
| :-------------------- | :------------------------------------------------------- | :-------------------------------------------- | :----------------------------------------------------------- |
| **`kind`**            | Connector sub-type                                       | `line` or `arc`                               |                                                              |
| **`children`**        | Array of children diagram items associated with the item | An array of diagram items numerical ids       |                                                              |
| **`connected`**       | List of the diagram items connected by this edge         | An array of diagram items numerical ids       |                                                              |
| **`ports`**           | List of the connection ports associated with this edge   | A list of ports numerical ids                 |                                                              |
| **`p1Decoration`**    | Decoration **of a “line” edge** first point              | `arrow-head` in case an arrow head is present | This property is absent if there is no decoration and only applies to “line” edges |
| **`p2Decoration`**    | Decoration**of a “line” edge** second point              | `arrow-head` in case an arrow head is present | This property is absent if there is no decoration and only applies to “line” edges |
| **`startDecoration`** | Decoration **of an “arc” edge** start point              | `arrow-head` in case an arrow head is present | This property is absent if there is no decoration and only applies to “arc” edges |
| **`endDecoration`**   | Decoration **of an “arc” edge** end point                | `arrow-head` in case an arrow head is present | This property is absent if there is no decoration and only applies to “arc” edges |

Example of a “straight” edge:

```json
{
 "type": "Edge",
 "kind": "line",
 "connected": [ 18, 30 ],
 "ports": [ 1, 0 ],
 "id": 8,
 "bounding-box": { ... },
 "items": [ ... ],
 "x1": 20.240625,
 "y1": 45.161953,
 "x2": 58.34063,
 "y2": 27.649166,
 "p2Decoration": "arrow-head"
}
```

Note that as a “line” connector, the edge includes , , and properties, defined the exact same way than in the case of [line items](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#line-item).`x1``y1``x2``y2`

Example of a “curved” edge:

```json
{
 "type": "Edge",
 "kind": "arc",
 "id": 40,
 "bounding-box": { ... },
 "items": [ ... ],
 "connected": [ 30, 18 ],
 "ports": [ 0, 1 ],
 "cx": 47.004948,
 "cy": 50.038963,
 "rx": 33.323929,
 "ry": 33.323929,
 "phi": 0.0051990449,
 "startAngle": -2.9348991,
 "sweepAngle": 1.8149548
}
```

Note that as an “arc” connector, the edge includes , , , , , and properties, defined the exact same way than in the case of [arc items](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#arc-item).`cx``cy``rx``ry``phi``startAngle``sweepAngle`

**• 图`形多边`块**

类型的关系图项通过其他几个边连接其他关系图项。它与以下属性相关联：`Polyedge`

| 财产            | 描述                         | 内容                |
| :-------------- | :--------------------------- | :------------------ |
| **`connected`** | 由此多边连接的关系图项的列表 | 图表数组项数字 ID。 |
| **`edges`**     | 构成此多边边的边缘列表       | 关系图边项的列表    |

聚边将三条边聚集在一起的示例：

```json
{
 "type": "Edge",
 "kind": "polyedge",
 "id": 65,
 "connected": [ 19, 41, 8 ],
 "edges": [ {
   "type": "Edge",
   "kind": "line",
   ...
  }, {
   "type": "Edge",
   "kind": "line",
   ...
  }, {
   "type": "Edge",
   "kind": "line",
   ...
  } ]
}
```

**• 图表`文本`块**

类型的关系图项结合了关系图项的属性和[文本块](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#text-block)的属性。它使用[文本范围进行样式设置](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#text-span-styling)。`Text`

### [绘图块](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#drawing-block)

绘图块收集原始数字墨水。

它具有以下特定属性：

| 财产        | 描述                     | 内容                                                         | 注意                                                         |
| :---------- | :----------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| **`items`** | 墨水组成块。             | [描边项](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#stroke-item)数组 | 当[配置为](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)`export.jiix.strokes``true` |
| **`spans`** | 提供样式信息的项范围列表 | [项范围对象的](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#item-span-styling)数组 | 当[配置为](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)`export.jiix.style``true` |

例子：

```json
{
 "type": "Drawing",
 "id": "7635",
 "bounding-box": { ... },
 "items": [ ... ],
 "spans": [ ... ]
}
```

### [数学块](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#math-block)

类型块与以下属性相关联：`Math`

| 财产              | 描述                       | 内容                                                         |
| :---------------- | :------------------------- | :----------------------------------------------------------- |
| **`expressions`** | 已识别的数学表达式的数组。 | [数学节点块](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#math-node-block)的数组。 |

```json
{
 "type": "Math",
 "id": "4529",
 "bounding-box": { ... },
 "expressions": [ ... ]
}
```

### [数学`节点`块](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#math-node-block)

数学节点块描述数学表达式的一部分。根据数学节点，数学节点可能包含属性中的其他数学节点。`type``operands`

| 财产            | 描述                                  | 内容                                                         | 注意                                                         |
| :-------------- | :------------------------------------ | :----------------------------------------------------------- | :----------------------------------------------------------- |
| **`type`**      | 节点类型                              | 字符串                                                       | 示例： 、 、 、 、`+``-``number``square root`                |
| **`label`**     | 与节点关联的标签，当它与`type`        | 字符串                                                       | 例子：。。。`2.453...``√``θ``dx`                             |
| **`operands`**  | 与节点关联的操作数（如果有）。        | 数学节点数组                                                 |                                                              |
| **`generated`** | 信号表明节点是由 iink 引擎添加的      | 布尔                                                         | 当不存在时，此属性被视为`false`                              |
| **`value`**     | 与给定节点关联的数值                  | 数字                                                         | 当 iink SDK 解算器无法求解此特定节点时，不存在               |
| **`items`**     | 构成节点的墨水和/或字形               | [笔画](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#stroke-item)和/或[字形](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#glyph-item)项数组 | 仅当[配置为](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)时，JIIX 导出中才会存在描边，而 Glys 仅在[配置为](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)时才存在。`export.jiix.strokes``true``export.jiix.glyphs``true` |
| **`class`**     | 附加到节点的 CSS 类的名称             | 字符串                                                       | 当[配置为](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)`export.jiix.style``true` |
| **`style`**     | 内联 CSS 样式"覆盖"节点的任何默认样式 | 字符串                                                       | 当[配置为](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)`export.jiix.style``true` |

例子：

```json
{
 "type": "+",
 "id": "math/34",
 "items": [ ... ],
 "bounding-box": { ... },
 "operands": [ ... ]
}
```

**• 栅栏数学块**

类型的数学节点具有以下特定属性：`fence`

| 财产               | 描述                                                   | 内容   | 例子         |
| :----------------- | :----------------------------------------------------- | :----- | :----------- |
| **`open symbol`**  | 栅栏的开口符号。如果未设置此属性，则表示未识别打开符号 | 字符串 | `(`, ,`[``{` |
| **`close symbol`** | 关闭栅栏的符号。如果未设置此属性，则表示未识别关闭符号 | 字符串 | `)`, ,`]``}` |

**• 矩阵数学块**

类型的数学节点具有以下特定属性：`matrix`

| 财产        | 描述             | 内容                                  |
| :---------- | :--------------- | :------------------------------------ |
| **`rows`**  | 矩阵内容，每行行 | 对象数组，每个对象表示矩阵的行`cells` |
| **`cells`** | 矩阵行的内容     | 数学节点数组                          |

**• 系统数学块**

类型的数学节点具有以下特定属性：`system`

| 财产              | 描述             | 内容         |
| :---------------- | :--------------- | :----------- |
|                   |                  |              |
| **`expressions`** | 系统中表达式数组 | 数学节点数组 |

### [文本块](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#text-block)

类型块具有以下特定属性：`Text`

| 财产        | 描述                       | 内容                                                         | 注意                                                         |
| :---------- | :------------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| **`label`** | 与此文本块关联的识别结果   | 字符串                                                       | 例子：`"label": "Hello how are you?"`                        |
| **`words`** | 识别单词列表               | [单词对象的](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#word-object)数组 | 当[将单词配置为](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)`export.jiix.text.words``true` |
| **`chars`** | 识别字符列表               | [字符对象的](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#character-object)数组 | 字符仅在将 JIIX 导出配置为时存在[，](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)`export.jiix.text.chars``true` |
| **`spans`** | 提供样式信息的文本范围列表 | [文本跨对象](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#text-span-styling)数组 | 当[配置为](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/)`export.jiix.style``true` |

例子：

```json
{
 "type": "Text",
 "id": "7666",
 "bounding-box": { ... },
 "label": "hello",
 "words": [ ... ],
 "chars": [ ... ],
 "spans": [ ... ]
}
```

交互式墨迹 SDK**明确区分**为**隐式**换行符。每次编写器返回下一行的开头时都会检测到*显式*换行，但有空间在上一行的末尾插入单词。例如，显式换行符是通过重排操作保留的。*隐式*换行对应于用户在完全填充后进入新行的情况（基于视图大小）。

例如，假设我们编写的内容在视觉上如下所示：

```plaintext
Hello
there!
This is a bit more than a full
line
```

我们将假设第三行采用**视图的完整宽度**。

相应的 JIIX 导出将如下所示：

```json
{
 "type": "Text",
 "bounding-box": { ... },
 "label": "Hello\nthere!\nThis iis a bit more than a full\nline",
 "words": [ ... ],
 "linebreaks": [ {
   "line": 0
  }, {
   "line": 1
  } ],
 "version": "2",
 "id": "MainBlock"
}
```

请注意主 中的三条换行符。通过 属性，JIIX 格式显式显示第 0 行和第 1 行（前两行）上的换行符是*显式*换行符。`label``linebreaks`

### [原始内容块](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#raw-content-block)

原始内容块对应于原始数字墨迹分析的输出。它旨在表示与文本对应于非文本的墨迹与墨迹之间的分段，可选解释作为文本和形状识别结果表示为图表项的层次结构。

类型块具有以下特定属性：`Raw Content`

| 财产           | 描述                                                         | 内容                    |
| :------------- | :----------------------------------------------------------- | :---------------------- |
| **`elements`** | 原始内容项和/或图表项的数组，具体取决于是否设置为 或`raw-content.recognition.text``raw-content.recognition.shape``true``false` | 原始内容和/或图表项数组 |

Example:

```json
{
  "type": "Raw Content",
  "id": "MainBlock",
  "bounding-box": { ... },
  "elements": [ ... ]
}
```

### [Raw Content item block](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#raw-content-item-block)

In addition to common block properties, raw content item blocks also have the following specific properties:

| Property    | Description                                                  | Content                                                      | Note                                                         |
| :---------- | :----------------------------------------------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| **`kind`**  | Raw content item identified as representing “text” or “non-text” ink data | `text` or `non-text`                                         |                                                              |
| **`items`** | Ink composing the block.                                     | An array of [strokes items](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#stroke-item) | Strokes are present in JIIX export when is [configured](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/) to `export.jiix.strokes``true` |

Example:

```plaintext
{
 "type": "Raw Content",
 "kind": "text",
 "id": 13,
 "bounding-box": { ... },
 "items": [ ... ]
}
```



Although raw content item blocks have an property like other blocks, their identifier is a number and not a string. `id`

Styling of a raw content item block is similar to [Drawing](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#drawing-block) for text and non-text blocks without the recognition enabled, otherwise it is similar as that of [Diagram item blocks](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#diagram-item-block).

## [Math node complete overview](https://developer.myscript.com/docs/interactive-ink/1.3/reference/jiix/#math-node-complete-overview)

| `type`                       | `operands`            | other properties                           |
| :--------------------------- | :-------------------- | :----------------------------------------- |
| `number`                     | 0                     | `label`                                    |
| `symbol`                     | 0                     | `label`                                    |
| `group`                      | >=2                   |                                            |
| `+`                          | >=1                   |                                            |
| `-`                          | >=1                   |                                            |
| `×`（U+00D7：乘法符号）      | >=1                   |                                            |
| `/`                          | >=1                   |                                            |
| `÷`（U+00F7：部门标志）      | >=1                   |                                            |
| `fraction`                   | 2                     |                                            |
| `power`                      | 1                     |                                            |
| `!`                          | 1                     |                                            |
| `percentage`                 | 2 （参考， 百分比）   | `operator`或 （U+00D7：乘法符号）`+``-``×` |
| `=`                          | 2                     |                                            |
| `>`                          | 2                     |                                            |
| `<`                          | 2                     |                                            |
| `≈`（U+2248： 几乎等于）     | 2                     |                                            |
| `≃`（U+2243： 同音平样）     | 2                     |                                            |
| `≠`（U+2260：不等于）        | 2                     |                                            |
| `≡`（U+2261： 相同）         | 2                     |                                            |
| `≢`（U+2262： 不相同）       | 2                     |                                            |
| `≤`（U+2264： 小于等于）     | 2                     |                                            |
| `≥`（U+2265： 大于等于）     | 2                     |                                            |
| `≪`（U+226A：比不上）        | 2                     |                                            |
| `≫`（U+226B：大于）          | 2                     |                                            |
| `⇐`（U+21D0：向左双箭头）    | 2                     |                                            |
| `⇒`（U+21D2：右侧双箭头）    | 2                     |                                            |
| `⇔`（U+21D4：左右双箭头）    | 2                     |                                            |
| `∥`（U+2225：平行到）        | 2                     |                                            |
| `square root`                | 1                     | `√`（U+221A：平方根）                      |
| `system`                     | 0                     | `expressions`[节点]                        |
| `matrix`                     | 0                     | `rows`[`cells`]                            |
| `rows`                       | 0                     | `cells`[节点]                              |
| `fence`                      | 1                     | `open symbol`,`close symbol`               |
| `underscript`                | 2 （脚本， 下写）     |                                            |
| `overscript`                 | 2 （脚本， 超额脚本） |                                            |
| `underoverscript`            | 3（脚本、下标、超编） |                                            |
| `superscript`                | 2 （脚本， 超级脚本） |                                            |
| `subscript`                  | 2（脚本，下标）       |                                            |
| `subsuperscript`             | 3（脚本、下标、下标） |                                            |
| `presuperscript`             | 2 （脚本， 前编）     |                                            |
| `presubscript`               | 2（脚本、规定）       |                                            |
| `presubsuperscript`          | 3（脚本、序言、中标） |                                            |
| `partialfractionnumerator`   | 1 （分子）            |                                            |
| `partialfractiondenominator` | 1 （分母）            |                                            |
| `slantedfraction`            | 2 （分子，分母）      |                                            |

# 样式参考

## [来自 CSS 的限制](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#restrictions-from-css)

以下限制适用：

- 仅支持有限的 CSS 属性子集。
- 支持的类型不同于常规 CSS 类型（例如，类型选择器（如 ）或不支持）。`h1``p``div`
- 默认单位是，并且将忽略显式单位提供的属性。`mm`
- 关键字（如 ）或不支持。`inherit``initial``unset`
- 不支持通用选择器 （） 和组合器。`*`
- [表达颜色](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)的可能性受到限制。

## [类型层次结构](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#type-hierarchy)

交互式墨迹 SDK 公开以下类型层次结构：

- ```
  ink
  ```

  \- 对下面描述的所有类型进行分组：

  - `stroke`- 仅限手写笔画。
  - `glyph`- 转换文本字形。
  - `line`- 转换的行，例如转换关系图时获得的。
  - `arc`- 转换椭圆弧、椭圆和圆。
  - `guide`- 文本指南。

可以组合类和类型选择器：

```css
glyph.text {}
line.diagram {}
arc.diagram {}
```

## [每个内容类型的可用类](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#available-classes-per-content-type)

### [图表块](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#diagram-block)

| 类                                                           | 描述                           |
| :----------------------------------------------------------- | :----------------------------- |
| [`.diagram`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#diagram) | "图表"内容块中项目的默认类。   |
| [`.diagram-fill`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#diagram-fill) | 应用于填充图表形状的样式。     |
| [`.diagram-guideline`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#diagram-guideline) | 应用于关系图对齐参考线。       |
| [`.diagram-handle`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#diagram-handle) | 应用于关系图选择控点的样式。   |
| [`.diagram-selection`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#diagram-selection) | 应用于叠加关系图块选择的样式。 |

### [绘图块](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#drawing-block)

| 类                                                           | 描述                         |
| :----------------------------------------------------------- | :--------------------------- |
| [`.drawing`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#drawing) | "绘图"内容块中项目的默认类。 |

### [数学块](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#math-block)

| 类                                                           | 描述                           |
| :----------------------------------------------------------- | :----------------------------- |
| [`.math`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#math) | "Math"内容块中项目的默认类。   |
| [`.math-variable`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#math-variable) | 在墨迹转换后应用于变量的样式。 |
| [`.math-solved`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#math-solved) | 应用于解算器生成的字形的样式。 |

### [文本块](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#text-block)

| 类                                                           | 描述                                          |
| :----------------------------------------------------------- | :-------------------------------------------- |
| [`.text`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#text) | "文本"内容块中项目的默认类。                  |
| [`.text-heading1`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#text-heading1) | 级别**1（仅限文本文档）**的文本标题样式。     |
| [`.text-heading2`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#text-heading2) | 第 2 级**（仅限文本文档）**的文本标题样式。   |
| [`.text-emphasis1`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#text-emphasis1) | 文本强调类型类型**1（仅限文本文档）的**样式。 |
| [`.text-emphasis2`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#text-emphasis2) | 文本强调类型类型**2（仅限文本文档）的**样式。 |
| [`.text-highlight`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#text-highlight) | 突出显示文本的样式**（仅限文本文档）。**      |

"文本文档"部分中的行为如下所示：

- 在文本的整个段落下划线允许您循环浏览（双下划线）、（简单下划线）和基本文本（无下划线）。`text-heading1``text-heading2`
- 下划线部分文本允许您循环浏览（简单下划线）、（双下划线）和基本文本（无下划线）。`text-emphasis1``text-emphasis2`
- 在文本的一部分上盘旋允许您应用，再次循环删除它。`text-highlight`

### [原始内容部分](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#raw-content-part)

| 类                                                           | 描述                           |
| :----------------------------------------------------------- | :----------------------------- |
| [`.raw-content`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#raw-content) | "原始内容"部分中项目的默认类。 |

## [每个类的属性](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#properties-per-class)

### [`.diagram`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#diagram)

| 财产                       | 默认值     | 言论                                                         |
| :------------------------- | :--------- | :----------------------------------------------------------- |
| `font-family`              | "圣塞里夫" |                                                              |
| `font-style`               | 正常       |                                                              |
| `font-variant`             | 正常       |                                                              |
| `font-weight`              | 400        | 仅支持数值。                                                 |
| `font-size`                | 5          | 以毫米为单位（模型单位）。                                   |
| `line-height`              | 1.3        | 字体大小的乘数。                                             |
| `color`                    | #000000FF  | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |
| `-myscript-pen-width`      | 1.3        | 以毫米为单位（模型单位）。                                   |
| `-myscript-pen-brush`      | 费尔特彭   | 设置绘制的描边的画笔。不影响选择、处理和转换的形状。查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#myscript-pen-brush)。 |
| `-myscript-pen-fill-color` | #44AADF44  | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |

### [`.diagram-fill`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#diagram-fill)

| 财产                       | 默认值    | 言论                                                         |
| :------------------------- | :-------- | :----------------------------------------------------------- |
| `-myscript-pen-fill-style` | 固体      | 设置是否应填充形状。查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#myscript-pen-fill-style)。 |
| `-myscript-pen-fill-color` | #44AADF44 | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |

### [`.diagram-guideline`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#diagram-guideline)

| 财产                  | 默认值    | 言论                                                         |
| :-------------------- | :-------- | :----------------------------------------------------------- |
| `color`               | #1A8BFFFF | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |
| `-myscript-pen-width` | 1.3       | 以毫米为单位（模型单位）。                                   |

### [`.diagram-handle`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#diagram-handle)

| 财产                       | 默认值    | 言论                                                         |
| :------------------------- | :-------- | :----------------------------------------------------------- |
| `color`                    | #1A8BFFFF | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |
| `-myscript-pen-width`      | 1.3       | 以毫米为单位（模型单位）。                                   |
| `-myscript-pen-fill-color` | #44AADF88 | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |

### [`.diagram-selection`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#diagram-selection)

| 财产                       | 默认值    | 言论                                                         |
| :------------------------- | :-------- | :----------------------------------------------------------- |
| `color`                    | #1A8BFFFF | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |
| `-myscript-pen-width`      | 1.3       | 单位为 。`mm`                                                |
| `-myscript-pen-fill-color` | #44AADF44 | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |

### [`.drawing`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#drawing)

| 财产                  | 默认值    | 言论                                                         |
| :-------------------- | :-------- | :----------------------------------------------------------- |
| `color`               | #000000FF | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |
| `-myscript-pen-width` | 1.3       | 单位为 。`mm`                                                |
| `-myscript-pen-brush` | 费尔特彭  | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#myscript-pen-brush)。 |

### [`.math`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#math)

| 财产                  | 默认值    | 言论                                                         |
| :-------------------- | :-------- | :----------------------------------------------------------- |
| `font-family`         | STIX 一般 |                                                              |
| `font-style`          | 正常      |                                                              |
| `font-variant`        | 正常      |                                                              |
| `font-weight`         | 400       | 仅支持数值。                                                 |
| `color`               | #000000FF | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |
| `-myscript-pen-width` | 1.3       | 单位为 。`mm`                                                |
| `-myscript-pen-brush` | 费尔特彭  | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#myscript-pen-brush)。 |

### [`.math-variable`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#math-variable)

| 财产           | 默认值    | 言论                                                         |
| :------------- | :-------- | :----------------------------------------------------------- |
| `font-family`  | STIX      |                                                              |
| `font-style`   | 斜        |                                                              |
| `font-variant` | 正常      |                                                              |
| `font-weight`  | 400       | 仅支持数值。                                                 |
| `color`        | #000000FF | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |

### [`.math-solved`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#math-solved)

| 财产           | 默认值    | 言论                                                         |
| :------------- | :-------- | :----------------------------------------------------------- |
| `font-family`  | STIX 一般 |                                                              |
| `font-style`   | 正常      |                                                              |
| `font-variant` | 正常      |                                                              |
| `font-weight`  | 400       | 仅支持数值。                                                 |
| `color`        | #A8A8A8FF | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |

### [`.text`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#text)

| 财产                  | 默认值     | 言论                                                         |
| :-------------------- | :--------- | :----------------------------------------------------------- |
| `font-family`         | "圣塞里夫" |                                                              |
| `font-style`          | 正常       |                                                              |
| `font-variant`        | 正常       |                                                              |
| `font-weight`         | 400        | 仅支持数值。                                                 |
| `font-size`           | 5          | 以毫米为单位（模型单位）。                                   |
| `line-height`         | 1.3        | 字体大小的乘数。                                             |
| `color`               | #000000FF  | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |
| `-myscript-pen-width` | 1.3        | 以毫米为单位（模型单位）。                                   |
| `-myscript-pen-brush` | 费尔特彭   | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#myscript-pen-brush)。 |



当前 和 参数仅影响"文本"内容类型，而不影响"文本文档"。`.text``font-size``line-height`

手写参考线的间距（如果[启用](https://developer.myscript.com/docs/interactive-ink/1.3/reference/configuration/#text)）由 * 给出。例如，以下 CSS 对应于 13 毫米间距：`font-size``line-height`

```css
.text {
  font-size: 10;
  line-height: 1.3;
}
```

### [`.text-heading1`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#text-heading1)

| 财产                                         | 默认值     | 言论                                                         |
| :------------------------------------------- | :--------- | :----------------------------------------------------------- |
| `font-family`                                | "圣塞里夫" |                                                              |
| `font-style`                                 | 正常       |                                                              |
| `font-variant`                               | 正常       |                                                              |
| `font-weight`                                | 650        | 仅支持数值。                                                 |
| `font-size`                                  | 9.166667   | 以毫米为单位（模型单位）。                                   |
| `line-height`                                | 1.3        | 字体大小的乘数。                                             |
| `color`                                      | #000000FF  | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |
| `-myscript-pen-width`                        | 1.3        | 以毫米为单位（模型单位）。                                   |
| `-myscript-text-decoration-color`            | #000000FF  | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |
| `-myscript-text-decoration-background-color` | #FFFFFF00  | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |
| `-myscript-text-decoration-pen-width`        | 1.3        | 以毫米为单位（模型单位）。                                   |
| `-myscript-pen-brush`                        | 费尔特彭   | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#myscript-pen-brush)。 |

笔记：

- `-myscript-text-decoration-style`默认情况下设置为 。`double-underlined``stroke.text-heading1`
- `-myscript-text-decoration-style`默认情况下设置为 。`none``glyph.text-heading1`

### [`.text-heading2`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#text-heading2)

| 财产                                         | 默认值     | 言论                                                         |
| :------------------------------------------- | :--------- | :----------------------------------------------------------- |
| `font-family`                                | "圣塞里夫" |                                                              |
| `font-style`                                 | 正常       |                                                              |
| `font-variant`                               | 正常       |                                                              |
| `font-weight`                                | 650        | 仅支持数值。                                                 |
| `font-size`                                  | 6.25       | 以毫米为单位（模型单位）。                                   |
| `line-height`                                | 1.3        | 字体大小的乘数。                                             |
| `color`                                      | #000000FF  | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |
| `-myscript-pen-width`                        | 1.3        | 以毫米为单位（模型单位）。                                   |
| `-myscript-text-decoration-color`            | #000000FF  | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |
| `-myscript-text-decoration-background-color` | #FFFFFF00  | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |
| `-myscript-text-decoration-pen-width`        | 1.3        | 以毫米为单位（模型单位）。                                   |
| `-myscript-pen-brush`                        | 费尔特彭   | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#myscript-pen-brush)。 |

- `-myscript-text-decoration-style`默认情况下设置为 。`underlined``stroke.text-heading2`
- `-myscript-text-decoration-style`默认情况下设置为 。`none``glyph.text-heading2`

### [`.text-emphasis1`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#text-emphasis1)

| 财产                                         | 默认值     | 言论                                                         |
| :------------------------------------------- | :--------- | :----------------------------------------------------------- |
| `font-family`                                | "圣塞里夫" |                                                              |
| `font-style`                                 | 正常       |                                                              |
| `font-variant`                               | 正常       |                                                              |
| `font-weight`                                | 700        | 仅支持数值。                                                 |
| `font-size`                                  | 5.0        | 以毫米为单位（模型单位）。                                   |
| `color`                                      | #000000FF  | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |
| `-myscript-pen-width`                        | 1.3        | 以毫米为单位（模型单位）。                                   |
| `-myscript-text-decoration-color`            | #000000FF  | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |
| `-myscript-text-decoration-background-color` | #FFFFFF00  | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |
| `-myscript-text-decoration-pen-width`        | 1.3        | 以毫米为单位（模型单位）。                                   |
| `-myscript-pen-brush`                        | 费尔特彭   | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#myscript-pen-brush)。 |

- `-myscript-text-decoration-style`默认情况下设置为 。`underlined``stroke.emphasis1`
- `-myscript-text-decoration-style`默认情况下设置为 。`none``glyph.emphasis1`

### [`.text-emphasis2`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#text-emphasis2)

| 财产                                         | 默认值     | 言论                                                         |
| :------------------------------------------- | :--------- | :----------------------------------------------------------- |
| `font-family`                                | "圣塞里夫" |                                                              |
| `font-style`                                 | 正常       |                                                              |
| `font-variant`                               | 正常       |                                                              |
| `font-weight`                                | 700        | 仅支持数值。                                                 |
| `font-size`                                  | 5.0        | 以毫米为单位（模型单位）。                                   |
| `color`                                      | #000000FF  | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |
| `-myscript-pen-width`                        | 1.3        | 以毫米为单位（模型单位）。                                   |
| `-myscript-text-decoration-color`            | #000000FF  | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |
| `-myscript-text-decoration-background-color` | #FFFFFF00  | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |
| `-myscript-text-decoration-pen-width`        | 1.3        | 以毫米为单位（模型单位）。                                   |
| `-myscript-pen-brush`                        | 费尔特彭   | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#myscript-pen-brush)。 |

- `-myscript-text-decoration-style`默认情况下设置为 。`double-underlined``stroke.emphasis2`
- `-myscript-text-decoration-style`默认情况下设置为 。`none``glyph.emphasis2`

### [`.text-highlight`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#text-highlight)

| 财产                                         | 默认值     | 言论                                                         |
| :------------------------------------------- | :--------- | :----------------------------------------------------------- |
| `font-family`                                | "圣塞里夫" |                                                              |
| `font-style`                                 | 正常       |                                                              |
| `font-variant`                               | 正常       |                                                              |
| `font-weight`                                | 700        | 仅支持数值。                                                 |
| `font-size`                                  | 5.0        | 以毫米为单位（模型单位）。                                   |
| `-myscript-pen-width`                        | 1.3        | 以毫米为单位（模型单位）。                                   |
| `-myscript-text-decoration-color`            | #000000FF  | 如果未设置，将和当前笔颜色相同。查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。`-myscript-text-decoration-color` |
| `-myscript-text-decoration-background-color` | #FFED2666  | 如果未设置，将从当前笔颜色派生。查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。`-myscript-text-decoration-background-color` |
| `-myscript-text-decoration-pen-width`        | 1.3        | 以毫米为单位（模型单位）。                                   |
| `-myscript-pen-brush`                        | 费尔特彭   | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#myscript-pen-brush)。 |

### [`stroke.text-highlight`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#stroketext-highlight)

| 财产                              | 默认值           | 言论                                                         |
| :-------------------------------- | :--------------- | :----------------------------------------------------------- |
| `-myscript-text-decoration-style` | `framed-outline` | `framed-outline`仅显示装饰的框轮廓：属性将被忽略。`-myscript-text-decoration-background-color` |

### [`glyph.text-highlight`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#glyphtext-highlight)

| 财产                              | 默认值              | 言论                                                         |
| :-------------------------------- | :------------------ | :----------------------------------------------------------- |
| `-myscript-text-decoration-style` | `framed-background` | `framed-outline`不显示装饰的轮廓：属性被忽略。`-myscript-text-decoration-color` |

### [`.raw-content`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#raw-content)

| 财产                  | 默认值    | 言论                                                         |
| :-------------------- | :-------- | :----------------------------------------------------------- |
| `color`               | #000000FF | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)。 |
| `-myscript-pen-width` | 1.3       | 单位为 。`mm`                                                |
| `-myscript-pen-brush` | 费尔特彭  | 查看[可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#myscript-pen-brush)。 |

## [可能的值](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#possible-values)

### [颜色](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#colors)

颜色可以指定为 ， 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、`rgb()``rgba()``hsl()``hsla()``#rgb``#rgba``#rrggbb``#rrggbbaa`

**不支持命名颜色（`黑色`、`红色`等）。**

### [`-myscript-pen-brush`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#myscript-pen-brush)

笔刷的可能值为： 、 、 、 和 。`Polyline``FountainPen``CalligraphicQuill``CalligraphicBrush``Qalam``FeltPen`

### [`-myscript-text-decoration-style`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#myscript-text-decoration-style)

- `none`-没有装饰
- `underlined`- 简单的下划线。
- `double-underlined`- 双下划线。
- `framed`- 围绕内容和背景颜色绘制的矩形框架。
- `circled`- 围绕内容和背景颜色绘制的圆形框架。
- `framed-outline`- 内容周围的矩形框架，不绘制背景。
- `framed-background`- 内容周围的矩形框架，仅渲染背景。
- `circled-outline`- 围绕内容圈框，不绘制背景。
- `circled-background`- 在内容周围圈帧，只渲染背景。

### [`-myscript-pen-fill-style`](https://developer.myscript.com/docs/interactive-ink/1.3/reference/styling/#myscript-pen-fill-style)

- `none`-没有填充
- `solid`- 填充纯色。