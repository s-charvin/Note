---
title: "{{ffmpeg-libav}}"
description: ""
author: ""
tags: [""]
categories: ""
keywords:  [""]
draft: true
layout: ""
date: 2023-05-14 20:14:43
lastmod: 2023-05-14 21:24:16
---



`ffmpeg` 作为一个通用的媒体转换器, 其功能实现主要是通过几个基本的 libav 系列库来实现的. 首先, 其整个转换过程可以大致抽象为以下过程


首先在了解具体的转换过程前, 需要先介绍部分上述及其相关的抽象术语.

- 封装: 又称容器, 用于组合和存储多种编码后的媒体流(音频、视频、字幕、章节信息等), 方便对这些元素的统一管理. chang'jia
- 流(Stream): 流是媒体数据信息的一种传输方式, 一般的媒体传输会包含视频流(Video Stream)、音频流(Audio Stream)、字幕(Subtitle)、附件(t)、数据(d)等.
- 解封装(): 
- 数据包(Packet): 将所有的媒体流分割为一段段进行处理, 这些分段数据解析后会存放在各自类型的数据包(Packet)中. (一般一个 Packet 会存放一个视频帧或多个音频帧).
- 解码(): 一般的媒体数据均是经过压缩处理的, 因此这里是将输入数据还原为原始数据的过程.
- 帧(Frame): 编解码器真正处理的数据最小处理单元
- 编码(): 对原始数据进行加工或压缩, 然后输出的过程. (视频: H263、H264、H265、MPEG)


`ffmpeg` 调用 libavformat 库（包含 Demuxer, 解封装器）来读取输入文件并从中获取包含编码数据的数据包。当有多个输入文件时， `ffmpeg` 尝试通过跟踪任何活动输入流上的最低时间戳来使它们保持同步。然后将编码的数据包传递给解码器。解码器产生未压缩的帧（原始视频/PCM 音频/...）。过滤后，帧被传递给编码器，编码器对它们进行编码并输出编码数据包。最后，这些被传递给 muxer，它将编码的数据包写入输出文件。
